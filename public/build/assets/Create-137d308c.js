import{c as ue,W as ce,r as b,j as a}from"./app-2375f243.js";import{I as q}from"./InputError-68d6cb0c.js";import{P as de}from"./PanelLayout-e7050e06.js";/* empty css            */import ee from"./NumberFormatCustomUtils-dd38754a.js";import{C as se,u as ae,d as me,M as ie}from"./index.esm-24e1cabb.js";import{B as V}from"./Button-360edc97.js";import{m as pe}from"./motion-374d27a7.js";import{A as Q,T as P}from"./TextField-5b383e78.js";import{f as _}from"./helpers.segment-1ad107d9.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";var le={};Object.defineProperty(le,"__esModule",{value:!0});const fe={actions:"Actions",and:"et",cancel:"Annuler",changeFilterMode:"Changer le mode de filtre",changeSearchMode:"Changer le mode de recherche",clearFilter:"Effacer le filtre",clearSearch:"Effacer la recherche",clearSort:"Effacer le tri",clickToCopy:"Cliquer pour copier",collapse:"Réduire",collapseAll:"Réduire tout",columnActions:"Actions de colonne",copiedToClipboard:"Copié dans le presse-papier",dropToGroupBy:"Déposer pour grouper par {column}",edit:"Editer",expand:"Développer",expandAll:"Tout développer",filterArrIncludes:"Inclure",filterArrIncludesAll:"Tout inclure",filterArrIncludesSome:"Inclure",filterBetween:"Entre",filterBetweenInclusive:"Entre inclus",filterByColumn:"Filtrer par {column}",filterContains:"Contient",filterEmpty:"Vide",filterEndsWith:"Se termine par",filterEquals:"Egale",filterEqualsString:"Egale",filterFuzzy:"Flou",filterGreaterThan:"Plus grand que",filterGreaterThanOrEqualTo:"Plus grand que ou égale à",filterInNumberRange:"Entre",filterIncludesString:"Contient",filterIncludesStringSensitive:"Contient",filterLessThan:"Plus petit que",filterLessThanOrEqualTo:"Plus petit que ou égale à",filterMode:"Mode filtre: {filterType}",filterNotEmpty:"Pas vide",filterNotEquals:"Pas égal",filterStartsWith:"Commence avec",filterWeakEquals:"Egale",filteringByColumn:"Filtrage par {column} - {filterType} {filterValue}",goToFirstPage:"Aller à la première page",goToLastPage:"Aller à la dernière page",goToNextPage:"Aller à la page suivante",goToPreviousPage:"Aller à la page précédente",grab:"Saisir",groupByColumn:"Grouper par {column}",groupedBy:"Groupé par ",hideAll:"Cacher tout",hideColumn:"Cacher {column} colonne",max:"Max",min:"Min",move:"Déplacer",noRecordsToDisplay:"Aucun enregistrement à afficher",noResultsFound:"Aucun résultat trouvé",of:"de",or:"ou",pin:"Attacher",pinToLeft:"Épingler à gauche",pinToRight:"Épingler à droite",resetColumnSize:"Réinitialiser la taille de la colonne",resetOrder:"Réinitialiser l'ordre",rowActions:"Actions de ligne",rowNumber:"#",rowNumbers:"Numéros de ligne",rowsPerPage:"Lignes par page",save:"Sauvegarder",search:"Rechercher",selectedCountOfRowCountRowsSelected:"{selectedCount} sur {rowCount} ligne(s)",select:"Sélectionner",showAll:"Afficher tous",showAllColumns:"Afficher toutes les colonnes",showHideColumns:"Afficher/Masquer les colonnes",showHideFilters:"Afficher/Masquer les filtres",showHideSearch:"Afficher/Masquer la recherche",sortByColumnAsc:"Trier par {column} croissant",sortByColumnDesc:"Trier par {column} décroissant",sortedByColumnAsc:"Trié par {column} croissant",sortedByColumnDesc:"Trié par {column} décroissant",thenBy:", puis par ",toggleDensity:"Changer la densité",toggleFullScreen:"Passer en plein écran",toggleSelectAll:"Basculer tout sélectionner",toggleSelectRow:"Basculer la sélection de ligne",toggleVisibility:"Basculer la visibilité",ungroupByColumn:"Dissocier par {column}",unpin:"Détacher",unpinAll:"Tout détacher"};var oe=le.MRT_Localization_FR=fe,he={exports:{}};(function(k,te){(function(F,A){k.exports=A()})(ue,function(){var F=1e3,A=6e4,G=36e5,R="millisecond",C="second",w="minute",S="hour",h="day",L="week",x="month",X="quarter",i="year",d="date",Y="Invalid Date",ne=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,K=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,re={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var r=["th","st","nd","rd"],n=l%100;return"["+l+(r[(n-20)%10]||r[n]||r[0])+"]"}},B=function(l,r,n){var e=String(l);return!e||e.length>=r?l:""+Array(r+1-e.length).join(n)+l},D={s:B,z:function(l){var r=-l.utcOffset(),n=Math.abs(r),e=Math.floor(n/60),t=n%60;return(r<=0?"+":"-")+B(e,2,"0")+":"+B(t,2,"0")},m:function l(r,n){if(r.date()<n.date())return-l(n,r);var e=12*(n.year()-r.year())+(n.month()-r.month()),t=r.clone().add(e,x),o=n-t<0,s=r.clone().add(e+(o?-1:1),x);return+(-(e+(n-t)/(o?t-s:s-t))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:x,y:i,w:L,d:h,D:d,h:S,m:w,s:C,ms:R,Q:X}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},T="en",$={};$[T]=re;var U="$isDayjsObject",W=function(l){return l instanceof E||!(!l||!l[U])},j=function l(r,n,e){var t;if(!r)return T;if(typeof r=="string"){var o=r.toLowerCase();$[o]&&(t=o),n&&($[o]=n,t=o);var s=r.split("-");if(!t&&s.length>1)return l(s[0])}else{var c=r.name;$[c]=r,t=c}return!e&&t&&(T=t),t||!e&&T},p=function(l,r){if(W(l))return l.clone();var n=typeof r=="object"?r:{};return n.date=l,n.args=arguments,new E(n)},u=D;u.l=j,u.i=W,u.w=function(l,r){return p(l,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var E=function(){function l(n){this.$L=j(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[U]=!0}var r=l.prototype;return r.parse=function(n){this.$d=function(e){var t=e.date,o=e.utc;if(t===null)return new Date(NaN);if(u.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var s=t.match(ne);if(s){var c=s[2]-1||0,m=(s[7]||"0").substring(0,3);return o?new Date(Date.UTC(s[1],c,s[3]||1,s[4]||0,s[5]||0,s[6]||0,m)):new Date(s[1],c,s[3]||1,s[4]||0,s[5]||0,s[6]||0,m)}}return new Date(t)}(n),this.init()},r.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},r.$utils=function(){return u},r.isValid=function(){return this.$d.toString()!==Y},r.isSame=function(n,e){var t=p(n);return this.startOf(e)<=t&&t<=this.endOf(e)},r.isAfter=function(n,e){return p(n)<this.startOf(e)},r.isBefore=function(n,e){return this.endOf(e)<p(n)},r.$g=function(n,e,t){return u.u(n)?this[e]:this.set(t,n)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(n,e){var t=this,o=!!u.u(e)||e,s=u.p(n),c=function(O,v){var M=u.w(t.$u?Date.UTC(t.$y,v,O):new Date(t.$y,v,O),t);return o?M:M.endOf(h)},m=function(O,v){return u.w(t.toDate()[O].apply(t.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(v)),t)},f=this.$W,g=this.$M,y=this.$D,I="set"+(this.$u?"UTC":"");switch(s){case i:return o?c(1,0):c(31,11);case x:return o?c(1,g):c(0,g+1);case L:var N=this.$locale().weekStart||0,H=(f<N?f+7:f)-N;return c(o?y-H:y+(6-H),g);case h:case d:return m(I+"Hours",0);case S:return m(I+"Minutes",1);case w:return m(I+"Seconds",2);case C:return m(I+"Milliseconds",3);default:return this.clone()}},r.endOf=function(n){return this.startOf(n,!1)},r.$set=function(n,e){var t,o=u.p(n),s="set"+(this.$u?"UTC":""),c=(t={},t[h]=s+"Date",t[d]=s+"Date",t[x]=s+"Month",t[i]=s+"FullYear",t[S]=s+"Hours",t[w]=s+"Minutes",t[C]=s+"Seconds",t[R]=s+"Milliseconds",t)[o],m=o===h?this.$D+(e-this.$W):e;if(o===x||o===i){var f=this.clone().set(d,1);f.$d[c](m),f.init(),this.$d=f.set(d,Math.min(this.$D,f.daysInMonth())).$d}else c&&this.$d[c](m);return this.init(),this},r.set=function(n,e){return this.clone().$set(n,e)},r.get=function(n){return this[u.p(n)]()},r.add=function(n,e){var t,o=this;n=Number(n);var s=u.p(e),c=function(g){var y=p(o);return u.w(y.date(y.date()+Math.round(g*n)),o)};if(s===x)return this.set(x,this.$M+n);if(s===i)return this.set(i,this.$y+n);if(s===h)return c(1);if(s===L)return c(7);var m=(t={},t[w]=A,t[S]=G,t[C]=F,t)[s]||1,f=this.$d.getTime()+n*m;return u.w(f,this)},r.subtract=function(n,e){return this.add(-1*n,e)},r.format=function(n){var e=this,t=this.$locale();if(!this.isValid())return t.invalidDate||Y;var o=n||"YYYY-MM-DDTHH:mm:ssZ",s=u.z(this),c=this.$H,m=this.$m,f=this.$M,g=t.weekdays,y=t.months,I=t.meridiem,N=function(v,M,z,Z){return v&&(v[M]||v(e,o))||z[M].slice(0,Z)},H=function(v){return u.s(c%12||12,v,"0")},O=I||function(v,M,z){var Z=v<12?"AM":"PM";return z?Z.toLowerCase():Z};return o.replace(K,function(v,M){return M||function(z){switch(z){case"YY":return String(e.$y).slice(-2);case"YYYY":return u.s(e.$y,4,"0");case"M":return f+1;case"MM":return u.s(f+1,2,"0");case"MMM":return N(t.monthsShort,f,y,3);case"MMMM":return N(y,f);case"D":return e.$D;case"DD":return u.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return N(t.weekdaysMin,e.$W,g,2);case"ddd":return N(t.weekdaysShort,e.$W,g,3);case"dddd":return g[e.$W];case"H":return String(c);case"HH":return u.s(c,2,"0");case"h":return H(1);case"hh":return H(2);case"a":return O(c,m,!0);case"A":return O(c,m,!1);case"m":return String(m);case"mm":return u.s(m,2,"0");case"s":return String(e.$s);case"ss":return u.s(e.$s,2,"0");case"SSS":return u.s(e.$ms,3,"0");case"Z":return s}return null}(v)||s.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(n,e,t){var o,s=this,c=u.p(e),m=p(n),f=(m.utcOffset()-this.utcOffset())*A,g=this-m,y=function(){return u.m(s,m)};switch(c){case i:o=y()/12;break;case x:o=y();break;case X:o=y()/3;break;case L:o=(g-f)/6048e5;break;case h:o=(g-f)/864e5;break;case S:o=g/G;break;case w:o=g/A;break;case C:o=g/F;break;default:o=g}return t?o:u.a(o)},r.daysInMonth=function(){return this.endOf(x).$D},r.$locale=function(){return $[this.$L]},r.locale=function(n,e){if(!n)return this.$L;var t=this.clone(),o=j(n,e,!0);return o&&(t.$L=o),t},r.clone=function(){return u.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},l}(),J=E.prototype;return p.prototype=J,[["$ms",R],["$s",C],["$m",w],["$H",S],["$W",h],["$M",x],["$y",i],["$D",d]].forEach(function(l){J[l[1]]=function(r){return this.$g(r,l[0],l[1])}}),p.extend=function(l,r){return l.$i||(l(r,E,p),l.$i=!0),p},p.locale=j,p.isDayjs=W,p.unix=function(l){return p(1e3*l)},p.en=$[T],p.Ls=$,p.p={},p})})(he);function Ne({auth:k,produits:te,departements:F,departementPrincipal:A,motifs:G,fournisseurs:R,fournisseurPrincipal:C,devises:w,uniteMesures:S,errors:h,success:L,error:x,referentiels:X}){const{data:i,setData:d,post:Y,processing:ne}=ce({date:Date.now(),nom:"",prixAchat:"",prixVente:"",quantite:"",image:"",produit:null,motif:null,fournisseur:C,departement:A,uniteMesure:null,devise:null,commandes:[],depenses:[],montantDepense:"",totalCommande:null,totalDepense:null}),[K,re]=b.useState(!1),[B,D]=b.useState(!1),[T,$]=b.useState(!1),U=b.useMemo(()=>[{accessorKey:"nom",header:"Nom",Cell:({row:e})=>{var t;return(t=e.original.produit)==null?void 0:t.nom}},{accessorKey:"prixAchat",header:"Prix d'achat",Cell:({row:e})=>_(e.original.prixAchat)+" GNF"},{accessorKey:"quantite",header:"Quantité",Cell:({row:e})=>_(e.original.quantite)},{accessorKey:"montant",header:"Montant",Cell:({row:e})=>_(e.original.montant)+" GNF"},{accessorKey:"action",header:"Action",Cell:({row:e})=>a.jsx(V,{onClick:()=>E(e.original.id),variant:"contained",size:"small",color:"error",children:a.jsx(se,{})},e.original.id)}],[]),W=b.useMemo(()=>[{accessorKey:"motif",header:"Motif",Cell:({row:e})=>{var t;return(t=e.original.motif)==null?void 0:t.nom}},{accessorKey:"montant",header:"Montant",Cell:({row:e})=>_(e.original.montant)+" GNF"},{accessorKey:"action",header:"Action",Cell:({row:e})=>a.jsx(V,{onClick:()=>l(e.original.id),variant:"contained",size:"small",color:"error",type:"button",children:a.jsx(se,{})},e.original.id)}],[]),j=e=>{e.target.type==="checkbox"?d(e.target.name,e.target.checked):d(e.target.name,e.target.value)};function p(e){e.preventDefault(),Y(route("admin.stockAppro.store",k.user.id),{preserveScroll:!0})}b.useEffect(()=>{i.produit&&d("prixAchat",i.produit.prixAchat)},[i.produit]),b.useEffect(()=>{i.motif&&d("montantDepense","")},[i.motif]);function u(){if(i.produit&&i.prixAchat&&i.quantite){const e={id:i.produit.id,produit:i.produit,prixAchat:i.prixAchat,quantite:i.quantite,montant:i.prixAchat*i.quantite};let t=[],o=!1;i.commandes.map(s=>{s.id===e.id&&(s.prixAchat=e.prixAchat,s.quantite=parseInt(s.quantite)+parseInt(e.quantite),s.montant=parseInt(s.quantite)*parseInt(e.prixAchat),o=!0),t.push(s)}),o||t.push(e),d(s=>({...s,commandes:t,produit:null,prixAchat:"",quantite:""})),D("Produit ajouté avec succès"),setTimeout(()=>D(!1),3e3)}else $("Veuillez remplir les champs de la commande"),setTimeout(()=>$(!1),3e3)}b.useEffect(()=>{let e=0;i.commandes.map(t=>e+=parseInt(t.montant)),d("totalCommande",e)},[i.commandes]),b.useEffect(()=>{let e=0;i.depenses.map(t=>e+=parseInt(t.montant)),d("totalDepense",e)},[i.depenses]);function E(e){d("commandes",i.commandes.filter(t=>t.id!==e)),D("Produit retiré avec succès")}b.useEffect(()=>d(e=>({...e,quantite:""})),[i.produit]);function J(){if(i.motif&&i.montantDepense){let e={id:i.motif.id,motif:i.motif,montant:i.montantDepense},t=!1,o=[];i.depenses.map(s=>{s.id===i.motif.id&&(s.montant=e.montant,t=!0),o.push(s)}),t||o.push(e),d(s=>({...s,depenses:o,motif:null,montantDepense:""})),D("Dépense ajoutée avec succès"),setTimeout(()=>D(!1),3e3)}else $("Veuillez remplir les champs de la dépense"),setTimeout(()=>$(!1),3e3)}function l(e){d("depenses",i.depenses.filter(t=>t.id!==e)),D("Dépense retirée avec succès")}const r=ae({columns:U,data:i.commandes,state:{showProgressBars:K},localization:oe}),n=ae({columns:W,data:i.depenses,state:{showProgressBars:K},localization:oe});return a.jsx(de,{auth:k,success:B,error:T,active:"stock",sousActive:"appro",breadcrumbs:[{text:"Appro",href:route("admin.stockAppro.index",k.user.id),active:!1},{text:"Création",href:route("admin.stockAppro.create",[k.user.id]),active:!0}],children:a.jsx("div",{children:a.jsx("div",{className:"w-full",children:a.jsx(pe.div,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,type:"spring"},style:{width:"100%"},children:a.jsxs("form",{onSubmit:p,className:"w-full space-y-5 gap-5 rounded bg-white p-5",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 border p-3 rounded",children:[a.jsxs("div",{className:"w-full",children:[a.jsx("div",{className:"md:col-span-2 font-bold text-orange-500",children:"Date de la commande"}),a.jsx(me,{className:"w-full",value:i.date,onChange:e=>{d("date",e)}})]}),a.jsxs("div",{children:[a.jsx("div",{className:"md:col-span-2 font-bold text-orange-500",children:"Stock à approvisionner"}),a.jsx(Q,{value:i.departement,className:"w-full",onChange:(e,t)=>d("departement",t),disablePortal:!0,options:F,getOptionLabel:e=>"Stock "+e.nom,isOptionEqualToValue:(e,t)=>e.id===t.id,renderInput:e=>a.jsx(P,{fullWidth:!0,...e,placeholder:"Stock",label:e.nom})}),a.jsx(q,{message:h.departement})]}),a.jsxs("div",{children:[a.jsx("div",{className:"md:col-span-2 font-bold text-orange-500",children:"Fournisseur"}),a.jsx(Q,{value:i.fournisseur,className:"w-full",onChange:(e,t)=>d("fournisseur",t),disablePortal:!0,options:R,getOptionLabel:e=>e.nom,isOptionEqualToValue:(e,t)=>e.id===t.id,renderInput:e=>a.jsx(P,{fullWidth:!0,...e,placeholder:"Fournisseur principal",label:e.nom})}),a.jsx(q,{message:h.fournisseur})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 border p-3 rounded",children:[a.jsx("div",{className:"md:col-span-2 font-bold text-orange-500",children:"Ajout de produits à la commande"}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ie,{table:r})}),i.totalCommande?a.jsx("div",{className:"md:col-span-2 w-fit p-2 rounded bg-black text-white",children:"Total: "+_(i.totalCommande)+" GNF"}):"",a.jsxs("div",{children:[a.jsx(Q,{value:i.produit,className:"w-full",onChange:(e,t)=>d("produit",t),disablePortal:!0,options:te,getOptionLabel:e=>e.nom,isOptionEqualToValue:(e,t)=>e.id===t.id,renderInput:e=>a.jsx(P,{fullWidth:!0,...e,placeholder:"Produit",label:e.nom})}),a.jsx(q,{message:h["data.produit"]})]}),a.jsxs("div",{className:"w-full",children:[a.jsx(P,{value:i.prixAchat,InputProps:{inputComponent:ee,endAdornment:"GNF",inputProps:{max:1e11,min:-1e12,name:"prixAchat"}},className:"w-full",label:"Prix d'achat",name:"prixAchat",onChange:j}),a.jsx(q,{message:h.prixAchat})]}),a.jsxs("div",{className:"w-full",children:[a.jsx(P,{value:i.quantite,InputProps:{inputComponent:ee,inputProps:{max:1e11,min:-1e12,name:"quantite"}},className:"w-full",label:"Quantité",name:"quantite",onChange:j}),a.jsx(q,{message:h.quantite})]}),a.jsx("div",{className:"md:col-span-2 w-fit",children:a.jsx(V,{onClick:u,variant:"contained",sx:{color:"white"},color:"primary",type:"button",children:"Ajouter"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 border p-3 rounded",children:[a.jsx("div",{className:"md:col-span-2 font-bold text-orange-500",children:"Dépense supplémentaires"}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ie,{table:n})}),i.totalDepense?a.jsx("div",{className:"md:col-span-2 w-fit p-2 rounded bg-black text-white",children:"Total: "+_(i.totalDepense)+" GNF"}):"",a.jsxs("div",{children:[a.jsx(Q,{value:i.motif,className:"w-full",onChange:(e,t)=>d("motif",t),disablePortal:!0,options:G,getOptionLabel:e=>e.nom,isOptionEqualToValue:(e,t)=>e.id===t.id,renderInput:e=>a.jsx(P,{fullWidth:!0,...e,placeholder:"Motif",label:e.nom})}),a.jsx(q,{message:h["data.motif"]})]}),a.jsxs("div",{className:"w-full",children:[a.jsx(P,{value:i.montantDepense,InputProps:{inputComponent:ee,endAdornment:"GNF",inputProps:{max:1e11,min:-1e12,name:"montantDepense"}},className:"w-full",label:"montant",name:"montantDepense",onChange:j}),a.jsx(q,{message:h.montantDepense})]}),a.jsx("div",{className:"md:col-span-2 w-fit",children:a.jsx(V,{onClick:J,variant:"contained",sx:{color:"white"},color:"primary",type:"button",children:"Ajouter"})})]}),a.jsx("div",{className:"w-full md:col-span-2 flex gap-2 justify-end",children:a.jsx(V,{variant:"contained",color:"success",type:"submit",children:"Valider"})})]})})})})})}export{Ne as default};
