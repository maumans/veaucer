import{r as t,W as pe,j as e,y as S}from"./app-2375f243.js";import{P as he}from"./PanelLayout-e7050e06.js";/* empty css            */import{u as xe,D as p,a as h,b as x,c as k,C as je,M as fe}from"./index.esm-24e1cabb.js";import{V as ve,E as Ce,D as be,C as q,A as Ne,M as ye}from"./index.esm-858d862c.js";import{I as d}from"./InputError-68d6cb0c.js";import{B as i}from"./Button-360edc97.js";import{T as c,A as j}from"./TextField-5b383e78.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";function Me({auth:m,errors:l,produits:u,typeProduits:w,categories:E,error:I,success:K}){var W,_;const[G,P]=t.useState([]),[F,O]=t.useState(!1),[U,f]=t.useState(!1),[Y,g]=t.useState(!1),[H,A]=t.useState(0),[v,J]=t.useState([]),[C,Q]=t.useState(""),[b,X]=t.useState([]),[r,Z]=t.useState({pageIndex:u.current_page-1,pageSize:u.per_page});t.useEffect(()=>{A(u.total),P(u.data),g(!1)},[u]),t.useEffect(()=>{g(!0),f(!0),axios.post(route("admin.stockInventaire.paginationFiltre"),{start:r.pageIndex*r.pageSize,size:r.pageSize,filters:v??[],globalFilter:C??"",sorting:b??[]}).then(s=>{P(s.data.data),A(s.data.rowCount),f(!1),g(!1)}).catch(s=>{O(!0),console.error(I)}),O(!1),f(!1),g(!1)},[v,C,r.pageIndex,r.pageSize,b]);const{data:o,setData:n,post:$,put:ee,reset:N}=pe({id:"",nom:"",typeProduit:null,categorie:null}),[se,y]=t.useState(!1),[ae,T]=t.useState(!1),[te,z]=t.useState(!1),[oe,D]=t.useState(!1),ie=()=>{S.get(route("admin.stockAppro.create",m.user.id),{onSuccess:()=>N()})},M=()=>{y(!1)},R=()=>{T(!1)},ne=()=>{z(!1)},L=()=>{D(!1)},V=s=>{s.target.type==="checkbox"?n(s.target.name,s.target.checked):n(s.target.name,s.target.value)},le=()=>{$(route("admin.stockInventaire.store"),{onSuccess:()=>{N(),y(!1)}})},re=s=>{S.get(route("admin.stockInventaire.edit",[m.user.id,s.id]),{preserveScroll:!0})},de=s=>{n({id:s.id,nom:s.nom||"",typeProduit:s.type_souscripteur||null,categorie:s.categorie_souscripteur||null}),z(!0)},B=(s,a)=>{n({id:s,message:a}),D(!0)},ce=()=>{ee(route("admin.stockInventaire.update",o.id),{onSuccess:()=>{N(),T(!1)}})},ue=()=>{y(!1),S.delete(route("admin.stockInventaire.destroy",{id:o.id}))},me=t.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"stockGlobal",header:"Stock global"},{accessorKey:"stockMinimal",header:"Stock Minimal"},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:()=>de(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(ve,{})}),e.jsx(i,{onClick:()=>re(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(Ce,{})}),s.original.status?e.jsx(i,{onClick:()=>B(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(be,{})}):e.jsx(i,{onClick:()=>B(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(q,{})})]},s.original.id)}],[]),ge=xe({columns:me,data:G,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualSorting:!0,muiToolbarAlertBannerProps:F?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:J,onGlobalFilterChange:Q,onPaginationChange:Z,onSortingChange:X,rowCount:H,state:{columnFilters:v,globalFilter:C,isLoading:U,pagination:r,showAlertBanner:F,showProgressBars:Y,sorting:b},localization:ye});return e.jsx(he,{auth:m,success:K,error:I,errors:l,active:"stock",sousActive:"produit",breadcrumbs:[{text:"Inventaire",href:route("admin.stockInventaire.index",[m.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(i,{color:"warning",variant:"contained",onClick:ie,children:[e.jsx(Ne,{className:"mr-1"})," Faire un appro"]}),e.jsxs(p,{open:se,onClose:M,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Ajout du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:o.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:V}),e.jsx(d,{message:l.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{className:"w-full",onChange:(s,a)=>n("typeProduit",a),disablePortal:!0,options:w,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,a)=>s.id===a.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:l["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{className:"w-full",onChange:(s,a)=>n("categorie",a),disablePortal:!0,options:E,groupBy:s=>s.categorie.libelle,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,a)=>s.id===a.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:l["data.categorie"]})]})]})}),e.jsxs(k,{children:[e.jsx(i,{variant:"contained",color:"error",onClick:M,children:"Annuler"}),e.jsx(i,{variant:"contained",color:"success",onClick:le,children:"Enregistrer"})]})]}),e.jsxs(p,{open:ae,onClose:R,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Modification du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:o.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:V}),e.jsx(d,{message:l.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{value:o.typeProduit,className:"w-full",onChange:(s,a)=>n("typeProduit",a),disablePortal:!0,options:w,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,a)=>s.id===a.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:l["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{value:o.categorie,className:"w-full",onChange:(s,a)=>n("categorie",a),disablePortal:!0,options:E,groupBy:s=>s.categorie.libelle,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,a)=>s.id===a.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:l["data.categorie"]})]})]})}),e.jsxs(k,{children:[e.jsx(i,{variant:"contained",color:"error",onClick:R,children:"Annuler"}),e.jsx(i,{variant:"contained",color:"success",onClick:ce,children:"Enregistrer"})]})]}),e.jsxs(p,{open:te,onClose:ne,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Details du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:o.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(W=o.typeProduit)==null?void 0:W.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CATEGORIE"}),e.jsx("div",{className:"py-2 px-2",children:(_=o.categorie)==null?void 0:_.nom})]})]})})]}),e.jsxs(p,{open:oe,onClose:L,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Suppression du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[o.message==="delete"&&"Voulez-vous vraiment suspendre ce produit",o.message==="check"&&"Voulez-vous vraiment débloquer ce produit"]})}),e.jsxs(k,{children:[e.jsxs(i,{variant:"contained",color:"error",onClick:L,children:[e.jsx(je,{}),"  Non"]}),e.jsxs(i,{variant:"contained",color:"success",onClick:ue,children:[e.jsx(q,{})," Oui"]})]})]})]}),e.jsx(fe,{table:ge})]})})}export{Me as default};
