import{r as l,W as Ce,j as e,y as S}from"./app-eb4ac14d.js";import{u as we,M as Se}from"./index.esm-c4a53501.js";import{M as Ne}from"./index.esm-4bae7fd4.js";import{I as W}from"./InputError-72dd93fb.js";import{P as ye,S as q}from"./PanelLayout-9db7ade9.js";import{B as r}from"./Button-7f8b9a63.js";import{P as H}from"./PictureAsPdf-a2d36ec4.js";import{A as ke}from"./AddCircle-9c227046.js";import{D as N,a as y,b as J}from"./DialogContent-a8b90f31.js";import{D as k}from"./DialogTitle-7e680bb7.js";import{T as Q,M as Ee}from"./TextField-22f70a44.js";import{C as Re}from"./Close-7d5020eb.js";import{C as U}from"./Check-b85e105e.js";import{V as Me}from"./Visibility-c9cb56b1.js";import{E as Fe}from"./Edit-9517b33c.js";import{D as Ie}from"./Delete-98ed2789.js";import{M as E}from"./MenuItem-3d0941cb.js";import"./createSvgIcon-4d9a41bc.js";import"./index-cf4ee6ec.js";import"./Cancel-8205af54.js";import"./Edit-17e2fc58.js";import"./TableRow-9f6508f6.js";import"./Popper-1f680820.js";import"./DatePicker-25bc8498.js";import"./Chip-bb44338a.js";import"./LastPage-4e97b798.js";import"./SwitchBase-3ba62cb7.js";import"./Checkbox-ae5cc143.js";import"./Stack-ebf23453.js";import"./CircularProgress-c9ab41e4.js";import"./Switch-31212aee.js";import"./Autocomplete-7942bf2c.js";import"./Dropdown-8c28aa27.js";import"./transition-a13fe195.js";function us({auth:a,roles:d,error:u,errors:R,success:g,total:X,actif:Y,inactif:Z}){var V,_,G;const[$,M]=l.useState([]),[F,I]=l.useState(!1),[ee,n]=l.useState(!1),[se,t]=l.useState(!1),[le,P]=l.useState(0),[A,D]=l.useState(null),oe=!!A,ie=s=>{D(s.currentTarget)},x=()=>{D(null)},[m,te]=l.useState([]),[h,re]=l.useState(""),[f,ae]=l.useState([]),[c,ne]=l.useState({pageIndex:d.current_page-1,pageSize:d.per_page}),{data:o,setData:p,post:ce,put:Pe,reset:j}=Ce({id:"",slug:"",name:"",libelle:"",filters:m??[]});l.useEffect(()=>{P(d.total),M(d.data),t(!1)},[d]),l.useEffect(()=>{t(!0),n(!0),axios.post(route("role.paginationFiltre"),{start:c.pageIndex*c.pageSize,size:c.pageSize,filters:m??[],globalFilter:h??"",sorting:f??[]}).then(s=>{M(s.data.data),P(s.data.rowCount),n(!1),t(!1)}).catch(s=>{I(!0)}),I(!1),n(!1),t(!1)},[m,h,c.pageIndex,c.pageSize,f]);const[v,z]=l.useState(!1);l.useState(!1);const[de,B]=l.useState(!1),[me,b]=l.useState(!1),pe=()=>{S.get(route("role.create"),{onSuccess:()=>j()})},C=()=>{z(!1)},ue=()=>{B(!1)},L=()=>{b(!1)},T=s=>{s.target.type==="checkbox"?p(s.target.name,s.target.checked):p(s.target.name,s.target.value)},ge=()=>{t(!0),n(!0),ce(route("role.store"),{onSuccess:()=>{j(),z(!1),t(!0),n(!0)}})},xe=s=>{console.log(s),S.get(route("role.edit",s.id),o,{onSuccess:()=>j()})},he=s=>{p({id:s.id,slug:s.slug,name:s.name||"",libelle:s.libelle||"",permissions:s.permissions||[]}),B(!0)},O=(s,i)=>{p({slug:s,message:i}),b(!0)},fe=()=>{t(!0),n(!0),b(!1),S.delete(route("role.destroy",{slug:o.slug}),{preserveScroll:!0,onSuccess:()=>{t(!1),n(!1)}})},je=[{permission:"show-roles",condition:s=>!0,title:"Détails",color:"secondary",icon:e.jsx(Me,{}),onClick:s=>he(s.original)},{permission:"edit-roles",condition:s=>!0,title:"Modifier",color:"info",icon:e.jsx(Fe,{}),onClick:s=>xe(s.original)},{permission:"delete-roles",condition:s=>s.original.status,title:"Suspendre",color:"error",icon:e.jsx(Ie,{}),onClick:s=>O(s.original.slug,"delete")},{permission:"delete-roles",condition:s=>!s.original.status,title:"Activer",color:"success",icon:e.jsx(U,{}),onClick:s=>O(s.original.slug,"check")}],ve=l.useMemo(()=>[{accessorKey:"name",header:"Nom"},{accessorKey:"libelle",header:"Libelle"},{accessorKey:"action",header:"Action",enableColumnFilter:!1,Cell:({row:s})=>e.jsx("div",{className:"flex gap-2",children:je.map(i=>{var K;return((K=a==null?void 0:a.permissions)==null?void 0:K.includes(i.permission))&&i.condition(s)&&e.jsx(r,{title:i.title,onClick:()=>i.onClick(s),variant:"outlined",size:"small",color:i.color,children:i.icon},i.permission)})},s.original.id)}],[]),w=s=>{},be=we({columns:ve,data:$,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:F?{color:"error",children:"Erreur de chargement des données"}:void 0,onColumnFiltersChange:te,onGlobalFilterChange:re,onPaginationChange:ne,onSortingChange:ae,rowCount:le,state:{columnFilters:m,globalFilter:h,isLoading:ee,pagination:c,showAlertBanner:F,showProgressBars:se,sorting:f},localization:Ne,renderTopToolbarCustomActions:({table:s})=>e.jsxs("div",{className:"flex",children:[e.jsx(r,{id:"basic-button","aria-controls":v?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":v?"true":void 0,size:"small",color:"error",onClick:ie,startIcon:e.jsx(H,{color:"error"}),children:"Export"}),e.jsxs(Ee,{id:"basic-menu",anchorEl:A,open:oe,onClose:C,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(E,{onClick:()=>{w(s.getPrePaginationRowModel().rows),x()},disabled:s.getPrePaginationRowModel().rows.length===0,children:"Toutes les lignes"}),e.jsx(E,{onClick:()=>{w(s.getRowModel().rows),x()},disabled:s.getRowModel().rows.length===0,children:"Lignes de la page"}),e.jsx(E,{onClick:()=>{w(s.getSelectedRowModel().rows),x()},disabled:!s.getIsSomeRowsSelected()&&!s.getIsAllRowsSelected(),children:"Lignes selectionnées"})]})]})});return e.jsxs(ye,{auth:a,success:g,error:u,active:"role",children:[e.jsxs("div",{className:"grid gap-2 w-full mb-20",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("div",{className:"w-full flex lg:hidden primaryBgColor p-1 font-bold text-white rounded",children:"Gestion des roles"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 w-full",children:[e.jsxs("div",{className:"bg-orange-500 text-white p-2 rounded",children:[e.jsx("div",{className:"text-3xl font-bold",children:X}),e.jsx("div",{children:"Roles"})]}),e.jsxs("div",{className:"bg-green-500 text-white p-2 rounded",children:[e.jsx("div",{className:"text-3xl font-bold",children:Y}),e.jsx("div",{children:"Actifs"})]}),e.jsxs("div",{className:"bg-red-500 text-white p-2 rounded",children:[e.jsx("div",{className:"text-3xl font-bold",children:Z}),e.jsx("div",{children:"Inactifs"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"contained",color:"error",size:"small",children:e.jsx(H,{size:5,className:"text-white"})}),(V=a==null?void 0:a.permissions)==null?void 0:V.map(s=>s==="create-roles"?e.jsxs(r,{onClick:pe,variant:"contained",color:"secondary",size:"small",children:[e.jsx(ke,{className:"text-white"})," ",e.jsx("div",{className:"text-white",children:"Role"})]},s):"")]}),e.jsx("div",{className:"w-full overflow-hidden",children:e.jsx(Se,{table:be})}),e.jsxs(N,{open:v,onClose:C,children:[e.jsx(k,{className:"primaryBgColor text-white",children:"Ajout d'un role"}),e.jsx(y,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(Q,{value:o.name,autoFocus:!0,id:"name",name:"name",label:"Nom",className:"bg-white",fullWidth:!0,onChange:T}),e.jsx(W,{message:R.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(Q,{value:o.libelle,id:"libelle",name:"libelle",label:"Libellé",className:"bg-white",fullWidth:!0,onChange:T}),e.jsx(W,{message:R.libelle,className:"mt-2"})]})]})}),e.jsxs(J,{children:[e.jsx(r,{variant:"contained",color:"error",onClick:C,children:"Annuler"}),e.jsx(r,{variant:"contained",color:"success",onClick:ge,children:"Enregistrer"})]})]}),e.jsxs(N,{open:de,onClose:ue,children:[e.jsx(k,{className:"primaryBgColor text-white",children:"Details du role"}),e.jsxs(y,{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 mt-5 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:o.name})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"LIBELLE"}),e.jsx("div",{className:"py-2 px-2",children:o.libelle})]})]}),((_=o.permissions)==null?void 0:_.length)>0&&e.jsxs("div",{className:"p-2 bg-gray-100 rounded",children:[e.jsx("div",{className:"font-bold text-xl mb-4",children:"Permissions"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:(G=o.permissions)==null?void 0:G.map(s=>e.jsx("div",{className:"rounded primaryBgColor text-white p-2",children:s.libelle}))})]})]})]}),e.jsxs(N,{open:me,onClose:L,children:[e.jsx(k,{className:"primaryBgColor text-white",children:"Suppression du produit"}),e.jsx(y,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[o.message==="delete"&&"Voulez-vous vraiment suspendre ce role",o.message==="check"&&"Voulez-vous vraiment débloquer ce role"]})}),e.jsxs(J,{children:[e.jsxs(r,{variant:"contained",color:"error",onClick:L,children:[e.jsx(Re,{}),"  Non"]}),e.jsxs(r,{variant:"contained",color:"success",onClick:fe,children:[e.jsx(U,{})," Oui"]})]})]})]}),g&&e.jsx(q,{success:g}),u&&e.jsx(q,{error:u})]})}export{us as default};
