import{j as e,r as c,W as Ae,y as u}from"./app-80aef6d5.js";import{P as Ve,a as _,T as a,B as V}from"./PanelLayout-a81f80b5.js";/* empty css            */import{u as qe,M as We}from"./index.esm-6c7ac6f1.js";import{M as Ke}from"./index.esm-4bae7fd4.js";import{I as b}from"./InputError-be802d9f.js";import{B as l}from"./Button-1a27d212.js";import{V as Re}from"./Visibility-c61c2b57.js";import{E as Ge}from"./Edit-a5aa676d.js";import{D as Le}from"./Delete-63a8382e.js";import{C as ce}from"./Check-539a23f7.js";import{D as w,a as I,b as q}from"./DialogContent-4b6d900f.js";import{D as F}from"./DialogTitle-b41ccae4.js";import{T as C,F as z,I as D,S as P}from"./TextField-f4478316.js";import{A as T}from"./Autocomplete-6624bd2e.js";import{C as ue}from"./Close-ccc56ba6.js";import{G as d}from"./Grid-f4fe8f5e.js";import{W as me}from"./Warning-d83babae.js";import{c as W}from"./createSvgIcon-f9f11e70.js";import{T as $e}from"./TrendingUp-d1801c8e.js";import{M as m}from"./MenuItem-9b67b98a.js";import{C as E}from"./Chip-4667134d.js";import{A as Be}from"./AddCircle-fc1f093f.js";import{f as M}from"./helpers.segment-8c19304b.js";import"./Dropdown-7e91de2b.js";import"./transition-c702c485.js";import"./index-bfd76f8c.js";import"./Cancel-2b66ccf0.js";import"./Edit-fe6d01fe.js";import"./TableRow-8bf34bd7.js";import"./Popper-3a932d0a.js";import"./DatePicker-e4040754.js";import"./LastPage-91b1bb11.js";import"./SwitchBase-5ee4a60b.js";import"./Checkbox-b8c9b3ff.js";import"./Stack-748aea93.js";import"./CircularProgress-45c1cca5.js";import"./Switch-f95e3c95.js";const pe=W(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Ue=W(e.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload"),He=W(e.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");function Ti({auth:n,errors:g,produits:k,typeProduits:S,categories:N,departements:y,error:xe,success:he,filters:t,stats:r}){var ee,ie,re,oe,te,le,ne,ae,se;const[K,ge]=c.useState({pageIndex:k.current_page-1,pageSize:k.per_page}),[j,R]=c.useState((t==null?void 0:t.categorie_id)||""),[v,G]=c.useState((t==null?void 0:t.type_produit_id)||""),[p,L]=c.useState((t==null?void 0:t.stock_filter)||"all"),[f,$]=c.useState((t==null?void 0:t.departement_id)||""),je=i=>{ge(i),u.get(route("admin.stock.produit.index",{userId:n.user.id}),{page:i.pageIndex+1,per_page:i.pageSize},{preserveState:!0,preserveScroll:!0,only:["produits"]})},ve=i=>{u.get(route("admin.stock.produit.index",{userId:n.user.id}),{search:i,page:1,categorie_id:j,type_produit_id:v,stock_filter:p,departement_id:f},{preserveState:!0,preserveScroll:!0,only:["produits"]})},x=(i,o)=>{switch(i){case"categorie":R(o);break;case"typeProduit":G(o);break;case"stock":L(o);break;case"departement":$(o);break}u.get(route("admin.stock.produit.index",{userId:n.user.id}),{search:(t==null?void 0:t.search)||"",page:1,categorie_id:i==="categorie"?o:j,type_produit_id:i==="typeProduit"?o:v,stock_filter:i==="stock"?o:p,departement_id:i==="departement"?o:f},{preserveState:!0,preserveScroll:!0,only:["produits","stats"]})},fe=i=>{i.length>0&&u.get(route("admin.stock.produit.index",{userId:n.user.id}),{sort_field:i[0].id,sort_direction:i[0].desc?"desc":"asc",page:K.pageIndex+1,categorie_id:j,type_produit_id:v,stock_filter:p,departement_id:f},{preserveState:!0,preserveScroll:!0,only:["produits"]})},ye=i=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"GNF",minimumFractionDigits:0}).format(i),{data:s,setData:h,post:be,put:Ce,reset:O}=Ae({id:"",nom:"",typeProduit:null,categorie:null}),[ke,A]=c.useState(!1),[Se,B]=c.useState(!1),[Ne,U]=c.useState(!1),[_e,H]=c.useState(!1),we=()=>{u.get(route("admin.stock.produit.create",{userId:n.user.id}),{onSuccess:()=>O()})},Ie=i=>{const o=i.target.files[0];if(o){const de=new FormData;de.append("file",o),u.post(route("admin.stock.produit.import-csv",{userId:n.user.id}),de,{onSuccess:()=>{i.target.value=null}})}},Q=()=>{A(!1)},Y=()=>{B(!1)},Fe=()=>{U(!1)},J=()=>{H(!1)},X=i=>{i.target.type==="checkbox"?h(i.target.name,i.target.checked):h(i.target.name,i.target.value)},ze=()=>{be(route("admin.produit.store"),{onSuccess:()=>{O(),A(!1)}})},De=i=>{u.get(route("admin.produit.edit",[n.user.id,i.id]),{preserveScroll:!0})},Pe=i=>{h({id:i.id,nom:i.nom||"",typeProduit:i.type_souscripteur||null,categorie:i.categorie_souscripteur||null}),U(!0)},Z=(i,o)=>{h({id:i,message:o}),H(!0)},Te=()=>{Ce(route("admin.produit.update",s.id),{onSuccess:()=>{O(),B(!1)}})},Ee=()=>{A(!1),u.delete(route("admin.produit.destroy",{id:s.id}))},Me=c.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"typeProduitAchat",header:"Option d'achat",Cell:({row:i})=>{var o;return(o=i.original.type_produit_achat)==null?void 0:o.libelle}},{accessorKey:"prixAchat",header:"Prix d'achat (GNF)",Cell:({row:i})=>M(i.original.prixAchat??0)},{accessorKey:"quantiteAchat",header:"Quantité à l'achat",Cell:({row:i})=>M(i.original.quantiteAchat??0)},{accessorKey:"typeProduitVente",header:"Option de vente",Cell:({row:i})=>{var o;return(o=i.original.type_produit_vente)==null?void 0:o.libelle}},{accessorKey:"prixVente",header:"Prix d'achat (GNF)",Cell:({row:i})=>M(i.original.prixVente??0)},{accessorKey:"quantiteVente",header:"Quantité à la vente",Cell:({row:i})=>M(i.original.quantiteVente??0)},{accessorKey:"categorie",header:"Categorie",Cell:({row:i})=>{var o;return(o=i.original.categorie)==null?void 0:o.libelle}},{accessorKey:"status",header:"Status",Cell:({row:i})=>i.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:i})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:()=>Pe(i.original),variant:"contained",size:"small",color:"info",children:e.jsx(Re,{})}),e.jsx(l,{onClick:()=>De(i.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(Ge,{})}),i.original.status?e.jsx(l,{onClick:()=>Z(i.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(Le,{})}):e.jsx(l,{onClick:()=>Z(i.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(ce,{})})]},i.original.id)}],[]),Oe=qe({columns:Me,data:k.data,getRowId:i=>i.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,onGlobalFilterChange:ve,onPaginationChange:je,onSortingChange:fe,rowCount:k.total,state:{pagination:K},localization:Ke});return e.jsx(Ve,{auth:n,success:he,error:xe,errors:g,active:"stock",sousActive:"produit",breadcrumbs:[{text:"Stock",href:route("admin.dashboard",{id:n.user.id}),active:!1},{text:"Produits",href:route("admin.stock.produit.index",{userId:n.user.id}),active:!0}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2 bg-black p-2 rounded",children:e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Liste des produits"})}),e.jsxs(w,{open:ke,onClose:Q,children:[e.jsx(F,{className:"bg-orange-600 text-white",children:"Ajout du produit"}),e.jsx(I,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(C,{value:s.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:X}),e.jsx(b,{message:g.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(T,{className:"w-full",onChange:(i,o)=>h("typeProduit",o),disablePortal:!0,options:S,getOptionLabel:i=>i.nom,isOptionEqualToValue:(i,o)=>i.id===o.id,renderInput:i=>e.jsx(C,{fullWidth:!0,...i,placeholder:"Type de produit",label:i.nom})}),e.jsx(b,{message:g["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(T,{className:"w-full",onChange:(i,o)=>h("categorie",o),disablePortal:!0,options:N,groupBy:i=>i.categorie.libelle,getOptionLabel:i=>i.nom,isOptionEqualToValue:(i,o)=>i.id===o.id,renderInput:i=>e.jsx(C,{fullWidth:!0,...i,placeholder:"Catégorie de produit",label:i.nom})}),e.jsx(b,{message:g["data.categorie"]})]})]})}),e.jsxs(q,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:Q,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:ze,children:"Enregistrer"})]})]}),e.jsxs(w,{open:Se,onClose:Y,children:[e.jsx(F,{className:"bg-orange-600 text-white",children:"Modification du produit"}),e.jsx(I,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(C,{value:s.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:X}),e.jsx(b,{message:g.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(T,{value:s.typeProduit,className:"w-full",onChange:(i,o)=>h("typeProduit",o),disablePortal:!0,options:S,getOptionLabel:i=>i.nom,isOptionEqualToValue:(i,o)=>i.id===o.id,renderInput:i=>e.jsx(C,{fullWidth:!0,...i,placeholder:"Type de produit",label:i.nom})}),e.jsx(b,{message:g["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(T,{value:s.categorie,className:"w-full",onChange:(i,o)=>h("categorie",o),disablePortal:!0,options:N,groupBy:i=>i.categorie.libelle,getOptionLabel:i=>i.nom,isOptionEqualToValue:(i,o)=>i.id===o.id,renderInput:i=>e.jsx(C,{fullWidth:!0,...i,placeholder:"Catégorie de produit",label:i.nom})}),e.jsx(b,{message:g["data.categorie"]})]})]})}),e.jsxs(q,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:Y,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:Te,children:"Enregistrer"})]})]}),e.jsxs(w,{open:Ne,onClose:Fe,children:[e.jsx(F,{className:"bg-orange-600 text-white",children:"Details du produit"}),e.jsx(I,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:s.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(ee=s.typeProduit)==null?void 0:ee.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CATEGORIE"}),e.jsx("div",{className:"py-2 px-2",children:(ie=s.categorie)==null?void 0:ie.nom})]})]})})]}),e.jsxs(w,{open:_e,onClose:J,children:[e.jsx(F,{className:"bg-orange-600 text-white",children:"Suppression du produit"}),e.jsx(I,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[s.message==="delete"&&"Voulez-vous vraiment suspendre ce produit",s.message==="check"&&"Voulez-vous vraiment débloquer ce produit"]})}),e.jsxs(q,{children:[e.jsxs(l,{variant:"contained",color:"error",onClick:J,children:[e.jsx(ue,{}),"  Non"]}),e.jsxs(l,{variant:"contained",color:"success",onClick:Ee,children:[e.jsx(ce,{})," Oui"]})]})]})]}),e.jsx("div",{children:e.jsxs(d,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(_,{elevation:2,sx:{p:2,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(a,{variant:"h6",color:"primary",children:"Total Produits"}),e.jsx(a,{variant:"h5",children:r!=null&&r.departement?r.departement.total_produits:(r==null?void 0:r.total_produits)||0})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(_,{elevation:2,sx:{p:2,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#fff9c4"},children:[e.jsxs(a,{variant:"h6",color:"warning.main",sx:{display:"flex",alignItems:"center"},children:[e.jsx(me,{fontSize:"small",sx:{mr:1}})," Stock Critique"]}),e.jsx(a,{variant:"h5",color:"warning.main",children:r!=null&&r.departement?r.departement.stockCritique:(r==null?void 0:r.stockCritique)||0}),e.jsx(a,{variant:"caption",color:"text.secondary",children:r&&(r.departement?`${Math.round((((re=r.departement)==null?void 0:re.stockCritique)||0)/(((oe=r.departement)==null?void 0:oe.total_produits)||1)*100)}%`:`${Math.round(((r==null?void 0:r.stockCritique)||0)/((r==null?void 0:r.total_produits)||1)*100)}%`)})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(_,{elevation:2,sx:{p:2,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#ffebee"},children:[e.jsxs(a,{variant:"h6",color:"error",sx:{display:"flex",alignItems:"center"},children:[e.jsx(pe,{fontSize:"small",sx:{mr:1}})," Stock Épuisé"]}),e.jsx(a,{variant:"h5",color:"error",children:r!=null&&r.departement?r.departement.stock_epuise:(r==null?void 0:r.stock_epuise)||0}),e.jsx(a,{variant:"caption",color:"text.secondary",children:r&&(r.departement?`${Math.round((((te=r.departement)==null?void 0:te.stock_epuise)||0)/(((le=r.departement)==null?void 0:le.total_produits)||1)*100)}%`:`${Math.round(((r==null?void 0:r.stock_epuise)||0)/((r==null?void 0:r.total_produits)||1)*100)}%`)})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(_,{elevation:2,sx:{p:2,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#e8f5e9"},children:[e.jsxs(a,{variant:"h6",color:"success.main",sx:{display:"flex",alignItems:"center"},children:[e.jsx($e,{fontSize:"small",sx:{mr:1}})," Valeur Stock"]}),e.jsx(a,{variant:"h5",color:"success.main",children:ye(r!=null&&r.departement?r.departement.valeur_totale_stock:(r==null?void 0:r.valeur_totale_stock)||0)})]})})]})}),e.jsxs("div",{className:"grid gap-2 bg-white p-2",children:[e.jsxs(d,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(a,{variant:"subtitle1",sx:{mb:1,fontWeight:"bold"},children:"Filtres"})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(D,{children:"Département"}),e.jsxs(P,{value:f,onChange:i=>x("departement",i.target.value),label:"Département",children:[e.jsx(m,{value:"",children:"Tous les départements"}),y==null?void 0:y.map(i=>e.jsx(m,{value:i.id,children:i.nom},i.id))]})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(D,{children:"Catégorie"}),e.jsxs(P,{value:j,onChange:i=>x("categorie",i.target.value),label:"Catégorie",children:[e.jsx(m,{value:"",children:"Toutes les catégories"}),N.map(i=>e.jsx(m,{value:i.id,children:i.nom},i.id))]})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(D,{children:"Type de produit"}),e.jsxs(P,{value:v,onChange:i=>x("typeProduit",i.target.value),label:"Type de produit",children:[e.jsx(m,{value:"",children:"Tous les types"}),S.map(i=>e.jsx(m,{value:i.id,children:i.nom},i.id))]})]})}),e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(D,{children:"État du stock"}),e.jsxs(P,{value:p,onChange:i=>x("stock",i.target.value),label:"État du stock",children:[e.jsx(m,{value:"all",children:"Tous les produits"}),e.jsx(m,{value:"low",children:e.jsxs(V,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(me,{fontSize:"small",color:"warning",sx:{mr:1}}),"Stock critique"]})}),e.jsx(m,{value:"out",children:e.jsxs(V,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(pe,{fontSize:"small",color:"error",sx:{mr:1}}),"Stock épuisé"]})})]})]})})]}),(f||j||v||p!=="all")&&e.jsxs(V,{sx:{mb:2,display:"flex",flexWrap:"wrap",gap:1},children:[e.jsx(a,{variant:"body2",sx:{mr:1,display:"flex",alignItems:"center"},children:"Filtres actifs:"}),f&&e.jsx(E,{label:`Département: ${((ne=y==null?void 0:y.find(i=>i.id===parseInt(f)))==null?void 0:ne.nom)||""}`,onDelete:()=>x("departement",""),color:"primary",variant:"outlined",size:"small"}),j&&e.jsx(E,{label:`Catégorie: ${((ae=N.find(i=>i.id===parseInt(j)))==null?void 0:ae.nom)||""}`,onDelete:()=>x("categorie",""),color:"primary",variant:"outlined",size:"small"}),v&&e.jsx(E,{label:`Type: ${((se=S.find(i=>i.id===parseInt(v)))==null?void 0:se.nom)||""}`,onDelete:()=>x("typeProduit",""),color:"primary",variant:"outlined",size:"small"}),p!=="all"&&e.jsx(E,{label:p==="low"?"Stock critique":"Stock épuisé",onDelete:()=>x("stock","all"),color:p==="low"?"warning":"error",variant:"outlined",size:"small"}),e.jsx(l,{variant:"text",size:"small",startIcon:e.jsx(ue,{fontSize:"small"}),onClick:()=>{$(""),R(""),G(""),L("all"),u.get(route("admin.stock.produit.index",{userId:n.user.id}),{page:1})},children:"Réinitialiser tous les filtres"})]}),e.jsxs("div",{className:"flex gap-2 justify-end mb-2",children:[e.jsxs(l,{color:"success",variant:"outlined",onClick:()=>window.location.href=route("admin.stock.produit.export-csv",{userId:n.user.id}),children:[e.jsx(Ue,{className:"mr-1"})," Exporter CSV"]}),e.jsxs("label",{htmlFor:"upload-csv",children:[e.jsx("input",{style:{display:"none"},id:"upload-csv",name:"upload-csv",type:"file",accept:".csv",onChange:Ie}),e.jsxs(l,{color:"info",variant:"outlined",component:"span",children:[e.jsx(He,{className:"mr-1"})," Importer CSV"]})]}),e.jsxs(l,{color:"warning",variant:"contained",onClick:we,children:[e.jsx(Be,{className:"mr-1"})," Ajout produit"]})]}),e.jsx(We,{table:Oe})]})]})})}export{Ti as default};
