import{r as l,W as ge,j as e,y as P}from"./app-2375f243.js";import"./PanelLayout-e7050e06.js";import{R as pe}from"./ReferentielLayout-7339f89f.js";import{u as xe,D as j,a as f,b as v,c as w,C as je,M as fe}from"./index.esm-24e1cabb.js";import{V as ve,E as be,D as Ne,C as K,A as Ce,M as Se}from"./index.esm-858d862c.js";import{I as i}from"./InputError-68d6cb0c.js";import{B as c}from"./Button-360edc97.js";import{T as n,A as _,a as V}from"./TextField-5b383e78.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";/* empty css            */import"./Search-d7112b9b.js";function Le({auth:m,errors:t,referentiels:B,societes:u,typeSocietes:A,error:M,success:q}){var L;const[G,E]=l.useState([]),[T,k]=l.useState(!1),[U,b]=l.useState(!1),[Y,g]=l.useState(!1),[H,F]=l.useState(0),[p,J]=l.useState([]),[x,Q]=l.useState(""),[N,X]=l.useState([]),[h,Z]=l.useState({pageIndex:u.current_page-1,pageSize:u.per_page});l.useEffect(()=>{F(u.total),E(u.data),g(!1)},[u]),l.useEffect(()=>{g(!0),b(!0),console.log(p,x),axios.post(route("superAdmin.societe.paginationFiltre"),{start:h.pageIndex*h.pageSize,size:h.pageSize,filters:p??[],globalFilter:x??"",sorting:N??[]}).then(s=>{E(s.data.data),F(s.data.rowCount),b(!1),g(!1)}).catch(s=>{k(!0),console.error(M)}),k(!1),b(!1),g(!1)},[p,x,h.pageIndex,h.pageSize,N]);const{data:a,setData:r,post:$,put:ee,reset:C}=ge({id:"",nom:"",telephone1:"",telephone2:"",adresseMail:"",description:"",logo:"",typeSociete:null}),[se,D]=l.useState(!1),[ae,S]=l.useState(!1),[te,I]=l.useState(!1),[le,y]=l.useState(!1),ie=()=>{P.get(route("superAdmin.societe.create",m.user.id),{onSuccess:()=>C()})},z=()=>{D(!1)},W=()=>{S(!1)},oe=()=>{I(!1)},O=()=>{y(!1)},o=s=>{s.target.type==="checkbox"?r(s.target.name,s.target.checked):r(s.target.name,s.target.value)},ne=()=>{$(route("superAdmin.societe.store",{userId:m.user.id}),{onSuccess:()=>{C(),D(!1)}})},de=s=>{r({id:s.id,nom:s.nom||"",adresse:s.adresse||"",telephone1:s.telephone1||"",telephone2:s.telephone2||"",adresseMail:s.adresseMail||"",description:s.description||"",logo:s.logo||"",slug:s.slug||"",typeSociete:s.type_societe||null}),S(!0)},ce=s=>{r({id:s.id,nom:s.nom||"",telephone1:s.telephone1||"",telephone2:s.telephone2||"",adresseMail:s.adresseMail||"",description:s.description||"",logo:s.logo||"",slug:s.slug||"",typeSociete:s.type_societe||null}),I(!0)},R=(s,d)=>{r({id:s,message:d}),y(!0)},re=()=>{ee(route("superAdmin.societe.update",{userId:m.user.id,id:a.id}),{onSuccess:()=>{C(),S(!1)}})},me=()=>{P.delete(route("superAdmin.societe.destroy",{userId:m.user.id,id:a.id}),{onSuccess:()=>y(!1)})},he=l.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"typeSociete",header:"Type societe",Cell:({row:s})=>{var d;return(d=s.original.type_societe)==null?void 0:d.nom}},{accessorKey:"adresse",header:"Adresse"},{accessorKey:"description",header:"Description"},{accessorKey:"logo",header:"Logo"},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{onClick:()=>ce(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(ve,{})}),e.jsx(c,{onClick:()=>de(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(be,{})}),s.original.status?e.jsx(c,{onClick:()=>R(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(Ne,{})}):e.jsx(c,{onClick:()=>R(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(K,{})})]},s.original.id)}],[]),ue=xe({columns:he,data:G,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:T?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:J,onGlobalFilterChange:Q,onPaginationChange:Z,onSortingChange:X,rowCount:H,state:{columnFilters:p,globalFilter:x,isLoading:U,pagination:h,showAlertBanner:T,showProgressBars:Y,sorting:N},localization:Se});return e.jsx(pe,{success:q,error:M,auth:m,errors:t,referentiels:B,referentiel:"Société",active:"referentiel",sousActive:"superAdmin.societe.index",breadcrumbs:[{text:"Société",href:route("superAdmin.societe.index",m.user.id),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(c,{color:"warning",variant:"contained",onClick:ie,children:[e.jsx(Ce,{className:"mr-1"})," Ajout société"]}),e.jsxs(j,{open:se,onClose:z,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Ajout de la société"}),e.jsx(v,{children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded overflow-hidden z-50",children:[e.jsxs("div",{children:[e.jsx(n,{value:a.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(_,{className:"w-full",onChange:(s,d)=>r("typeSociete",d),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,d)=>s.id===d.id,renderInput:s=>e.jsx(n,{fullWidth:!0,...s,placeholder:"Type de societe",label:s.nom})}),e.jsx(i,{message:t["data.typeSociete"]})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.adresse,id:"adresse",name:"adresse",label:"Adresse",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.adresse,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.telephone1,id:"telephone1",name:"telephone1",label:"Tel",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.telephone1,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.telephone2,id:"telephone2",name:"telephone2",label:"Tel 2",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.telephone2,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.adresseMail,type:"mail",id:"adresseMail",name:"adresseMail",label:"Adresse mail",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.adresseMail,className:"mt-2"})]}),e.jsxs("div",{className:"md:col-span-2 mt-8",children:[e.jsx(V,{className:"w-full",name:"description",placeholder:"Description",style:{height:100},onChange:o,autoComplete:"description"}),e.jsx(i,{message:t["data.description"]})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.logo,id:"logo",name:"logo",label:"logo",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.logo,className:"mt-2"})]})]})}),e.jsxs(w,{children:[e.jsx(c,{variant:"contained",color:"error",onClick:z,children:"Annuler"}),e.jsx(c,{variant:"contained",color:"success",onClick:ne,children:"Enregistrer"})]})]}),e.jsxs(j,{open:ae,onClose:W,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Modification de la société"}),e.jsx(v,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(n,{value:a.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(_,{value:a.typeSociete,className:"w-full",onChange:(s,d)=>r("typeSociete",d),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,d)=>s.id===d.id,renderInput:s=>e.jsx(n,{fullWidth:!0,...s,placeholder:"Type de societe",label:s.nom})}),e.jsx(i,{message:t["data.typeSociete"]})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.adresse,id:"adresse",name:"adresse",label:"Adresse",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.adresse,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.telephone1,id:"telephone1",name:"telephone1",label:"Tel",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.telephone1,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.telephone2,id:"telephone2",name:"telephone2",label:"Tel 2",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.telephone2,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.adresseMail,type:"mail",id:"adresseMail",name:"adresseMail",label:"Adresse mail",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.adresseMail,className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2 mt-8",children:[e.jsx(V,{value:a.description,className:"w-full",name:"description",placeholder:"Description",style:{height:100},onChange:o,autoComplete:"description"}),e.jsx(i,{message:t["data.description"]})]}),e.jsxs("div",{children:[e.jsx(n,{value:a.logo,id:"logo",name:"logo",label:"logo",className:"bg-white",fullWidth:!0,onChange:o}),e.jsx(i,{message:t.logo,className:"mt-2"})]})]})}),e.jsxs(w,{children:[e.jsx(c,{variant:"contained",color:"error",onClick:W,children:"Annuler"}),e.jsx(c,{variant:"contained",color:"success",onClick:re,children:"Enregistrer"})]})]}),e.jsxs(j,{open:te,onClose:oe,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Details du societe"}),e.jsx(v,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:a.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"SLUG"}),e.jsx("div",{className:"py-2 px-2",children:a.slug})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(L=a.typeSociete)==null?void 0:L.nom})]})]})})]}),e.jsxs(j,{open:le,onClose:O,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Suppression du societe"}),e.jsx(v,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[a.message==="delete"&&"Voulez-vous vraiment suspendre cette societe",a.message==="check"&&"Voulez-vous vraiment débloquer cette societe"]})}),e.jsxs(w,{children:[e.jsxs(c,{variant:"contained",color:"error",onClick:O,children:[e.jsx(je,{}),"  Non"]}),e.jsxs(c,{variant:"contained",color:"success",onClick:me,children:[e.jsx(K,{})," Oui"]})]})]})]}),e.jsx(fe,{table:ue})]})})}export{Le as default};
