import{r as a,W as me,j as e,y as he}from"./app-2375f243.js";import"./PanelLayout-e7050e06.js";import{R as xe}from"./ReferentielLayout-7339f89f.js";import{u as je,D as j,a as f,b as S,c as w,C as fe,M as Se}from"./index.esm-24e1cabb.js";import{V as ve,E as Ce,D as be,C as K,A as Ne,M as ye}from"./index.esm-858d862c.js";import{I as n}from"./InputError-68d6cb0c.js";import{B as l}from"./Button-360edc97.js";import{T as c,A as v}from"./TextField-5b383e78.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";/* empty css            */import"./Search-d7112b9b.js";function We({auth:E,errors:o,referentiels:q,souscripteurs:d,typesSouscripteurs:A,categoriesSouscripteurs:F,error:k,success:B}){var M,V;const[G,I]=a.useState([]),[O,T]=a.useState(!1),[U,C]=a.useState(!1),[Y,p]=a.useState(!1),[H,z]=a.useState(0),[g,J]=a.useState([]),[m,Q]=a.useState(""),[b,X]=a.useState([]),[u,Z]=a.useState({pageIndex:d.current_page-1,pageSize:d.per_page});a.useEffect(()=>{z(d.total),I(d.data),p(!1)},[d]),a.useEffect(()=>{p(!0),C(!0),console.log(g,m),axios.post(route("superAdmin.souscripteur.paginationFiltre"),{start:u.pageIndex*u.pageSize,size:u.pageSize,filters:g??[],globalFilter:m??"",sorting:b??[]}).then(s=>{I(s.data.data),z(s.data.rowCount),C(!1),p(!1)}).catch(s=>{T(!0),console.error(k)}),T(!1),C(!1),p(!1)},[g,m,u.pageIndex,u.pageSize,b]);const{data:i,setData:r,post:$,put:ee,reset:N}=me({id:"",nom:"",slug:"",typeSouscripteur:null,categorieSouscripteur:null}),[se,h]=a.useState(!1),[te,y]=a.useState(!1),[ae,D]=a.useState(!1),[ie,R]=a.useState(!1),le=()=>{N(),h(!0)},P=()=>{h(!1)},_=()=>{y(!1)},oe=()=>{D(!1)},L=()=>{R(!1)},x=s=>{s.target.type==="checkbox"?r(s.target.name,s.target.checked):r(s.target.name,s.target.value)},re=()=>{$(route("superAdmin.souscripteur.store"),{onSuccess:()=>{N(),h(!1)}})},ne=s=>{r({id:s.id,nom:s.nom||"",slug:s.slug||"",typeSouscripteur:s.type_souscripteur||null,categorieSouscripteur:s.categorie_souscripteur||null}),y(!0)},ce=s=>{r({id:s.id,nom:s.nom||"",slug:s.slug||"",typeSouscripteur:s.type_souscripteur||null,categorieSouscripteur:s.categorie_souscripteur||null}),D(!0)},W=(s,t)=>{r({id:s,message:t}),R(!0)},ue=()=>{ee(route("superAdmin.souscripteur.update",i.id),{onSuccess:()=>{N(),y(!1)}})},de=()=>{h(!1),he.delete(route("superAdmin.souscripteur.destroy",{id:i.id}))},pe=a.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"slug",header:"Slug"},{accessorKey:"typeSouscripteur",header:"Type souscripteur",Cell:({row:s})=>{var t;return(t=s.original.type_souscripteur)==null?void 0:t.nom}},{accessorKey:"categorieSouscripteur",header:"Categorie souscripteur",Cell:({row:s})=>{var t;return(t=s.original.categorie_souscripteur)==null?void 0:t.nom}},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:()=>ce(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(ve,{})}),e.jsx(l,{onClick:()=>ne(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(Ce,{})}),s.original.status?e.jsx(l,{onClick:()=>W(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(be,{})}):e.jsx(l,{onClick:()=>W(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(K,{})})]},s.original.id)}],[]),ge=je({columns:pe,data:G,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:O?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:J,onGlobalFilterChange:Q,onPaginationChange:Z,onSortingChange:X,rowCount:H,state:{columnFilters:g,globalFilter:m,isLoading:U,pagination:u,showAlertBanner:O,showProgressBars:Y,sorting:b},localization:ye});return e.jsx(xe,{success:B,error:k,auth:E,errors:o,referentiels:q,referentiel:"Souscripteurs",active:"referentiel",sousActive:"superAdmin.souscripteur.index",breadcrumbs:[{text:"Souscripteur",href:route("superAdmin.souscripteur.index",[E.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(l,{color:"warning",variant:"contained",onClick:le,children:[e.jsx(Ne,{className:"mr-1"})," Ajout souscripteur"]}),e.jsxs(j,{open:se,onClose:P,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Ajout du souscripteur"}),e.jsx(S,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:i.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:x}),e.jsx(n,{message:o.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{value:i.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:x}),e.jsx(n,{message:o.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(v,{className:"w-full",onChange:(s,t)=>r("typeSouscripteur",t),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de souscripteur",label:s.nom})}),e.jsx(n,{message:o["data.typeSouscripteur"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(v,{className:"w-full",onChange:(s,t)=>r("categorieSouscripteur",t),disablePortal:!0,options:F,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de souscripteur",label:s.nom})}),e.jsx(n,{message:o["data.categorieSouscripteur"]})]})]})}),e.jsxs(w,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:P,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:re,children:"Enregistrer"})]})]}),e.jsxs(j,{open:te,onClose:_,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Modification du souscripteur"}),e.jsx(S,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:i.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:x}),e.jsx(n,{message:o.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{value:i.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:x}),e.jsx(n,{message:o.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(v,{value:i.typeSouscripteur,className:"w-full",onChange:(s,t)=>r("typeSouscripteur",t),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de souscripteur",label:s.nom})}),e.jsx(n,{message:o["data.typeSouscripteur"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(v,{value:i.categorieSouscripteur,className:"w-full",onChange:(s,t)=>r("categorieSouscripteur",t),disablePortal:!0,options:F,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de souscripteur",label:s.nom})}),e.jsx(n,{message:o["data.categorieSouscripteur"]})]})]})}),e.jsxs(w,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:_,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:ue,children:"Enregistrer"})]})]}),e.jsxs(j,{open:ae,onClose:oe,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Details du souscripteur"}),e.jsx(S,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:i.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"SLUG"}),e.jsx("div",{className:"py-2 px-2",children:i.slug})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(M=i.typeSouscripteur)==null?void 0:M.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CATEGORIE"}),e.jsx("div",{className:"py-2 px-2",children:(V=i.categorieSouscripteur)==null?void 0:V.nom})]})]})})]}),e.jsxs(j,{open:ie,onClose:L,children:[e.jsx(f,{className:"bg-orange-600 text-white",children:"Suppression du souscripteur"}),e.jsx(S,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[i.message==="delete"&&"Voulez-vous vraiment suspendre ce souscripteur",i.message==="check"&&"Voulez-vous vraiment débloquer ce souscripteur"]})}),e.jsxs(w,{children:[e.jsxs(l,{variant:"contained",color:"error",onClick:L,children:[e.jsx(fe,{}),"  Non"]}),e.jsxs(l,{variant:"contained",color:"success",onClick:de,children:[e.jsx(K,{})," Oui"]})]})]})]}),e.jsx(Se,{table:ge})]})})}export{We as default};
