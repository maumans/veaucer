import{r as a,W as ge,j as e,y as S}from"./app-2375f243.js";import{P as he}from"./PanelLayout-e7050e06.js";/* empty css            */import{u as xe,D as g,a as h,b as x,c as k,C as je,M as fe}from"./index.esm-24e1cabb.js";import{V as be,E as ve,D as Ce,C as B,A as Ne,M as ye}from"./index.esm-858d862c.js";import{I as d}from"./InputError-68d6cb0c.js";import{B as i}from"./Button-360edc97.js";import{T as c,A as j}from"./TextField-5b383e78.js";import{f as Se}from"./helpers.segment-1ad107d9.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";function Me({auth:m,errors:n,appros:u,typeProduits:w,categorieProduits:P,error:E,success:K}){var _,q;const[G,A]=a.useState([]),[F,O]=a.useState(!1),[U,f]=a.useState(!1),[Y,p]=a.useState(!1),[H,T]=a.useState(0),[b,J]=a.useState([]),[v,Q]=a.useState(""),[C,X]=a.useState([]),[r,Z]=a.useState({pageIndex:u.current_page-1,pageSize:u.per_page});a.useEffect(()=>{T(u.total),A(u.data),p(!1)},[u]),a.useEffect(()=>{p(!0),f(!0),axios.post(route("admin.stockAppro.paginationFiltre"),{start:r.pageIndex*r.pageSize,size:r.pageSize,filters:b??[],globalFilter:v??"",sorting:C??[]}).then(s=>{A(s.data.data),T(s.data.rowCount),f(!1),p(!1)}).catch(s=>{O(!0),console.error(E)}),O(!1),f(!1),p(!1)},[b,v,r.pageIndex,r.pageSize,C]);const{data:o,setData:l,post:$,put:ee,reset:N}=ge({id:"",nom:"",typeProduit:null,categorieProduit:null}),[se,y]=a.useState(!1),[te,I]=a.useState(!1),[ae,D]=a.useState(!1),[oe,z]=a.useState(!1),ie=()=>{S.get(route("admin.stockAppro.create",m.user.id),{onSuccess:()=>N()})},R=()=>{y(!1)},L=()=>{I(!1)},le=()=>{D(!1)},M=()=>{z(!1)},V=s=>{s.target.type==="checkbox"?l(s.target.name,s.target.checked):l(s.target.name,s.target.value)},ne=()=>{$(route("admin.stockAppro.store"),{onSuccess:()=>{N(),y(!1)}})},re=s=>{S.get(route("admin.stockAppro.edit",[m.user.id,s.id]),{preserveScroll:!0})},de=s=>{l({id:s.id,nom:s.nom||"",typeProduit:s.type_souscripteur||null,categorieProduit:s.categorie_souscripteur||null}),D(!0)},W=(s,t)=>{l({id:s,message:t}),z(!0)},ce=()=>{ee(route("admin.stockAppro.update",o.id),{onSuccess:()=>{N(),I(!1)}})},ue=()=>{y(!1),S.delete(route("admin.stockAppro.destroy",{id:o.id}))},me=a.useMemo(()=>[{accessorKey:"date",header:"Date"},{accessorKey:"total",header:"Total",valueLabelFormat:s=>Se(s.total)+" GNF"},{accessorKey:"fournisseur",header:"Fournisseur",Cell:({row:s})=>{var t;return(t=s.original.fournisseur)==null?void 0:t.nom}},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status==="commandé"?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:s.original.status}):s.original.status==="annulé"?e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:s.original.status}):e.jsx("div",{className:"p-2 font-bold bg-blue-500 text-white w-fit h-fit rounded",children:s.original.status})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:()=>de(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(be,{})}),e.jsx(i,{onClick:()=>re(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(ve,{})}),s.original.status?e.jsx(i,{onClick:()=>W(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(Ce,{})}):e.jsx(i,{onClick:()=>W(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(B,{})})]},s.original.id)}],[]),pe=xe({columns:me,data:G,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualSorting:!0,muiToolbarAlertBannerProps:F?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:J,onGlobalFilterChange:Q,onPaginationChange:Z,onSortingChange:X,rowCount:H,state:{columnFilters:b,globalFilter:v,isLoading:U,pagination:r,showAlertBanner:F,showProgressBars:Y,sorting:C},localization:ye});return e.jsx(he,{auth:m,success:K,error:E,errors:n,active:"stock",sousActive:"appro",breadcrumbs:[{text:"Appro",href:route("admin.stockAppro.index",[m.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(i,{color:"warning",variant:"contained",onClick:ie,children:[e.jsx(Ne,{className:"mr-1"})," Faire un appro"]}),e.jsxs(g,{open:se,onClose:R,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Ajout du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:o.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:V}),e.jsx(d,{message:n.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{className:"w-full",onChange:(s,t)=>l("typeProduit",t),disablePortal:!0,options:w,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:n["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{className:"w-full",onChange:(s,t)=>l("categorieProduit",t),disablePortal:!0,options:P,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:n["data.categorieProduit"]})]})]})}),e.jsxs(k,{children:[e.jsx(i,{variant:"contained",color:"error",onClick:R,children:"Annuler"}),e.jsx(i,{variant:"contained",color:"success",onClick:ne,children:"Enregistrer"})]})]}),e.jsxs(g,{open:te,onClose:L,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Modification du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:o.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:V}),e.jsx(d,{message:n.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{value:o.typeProduit,className:"w-full",onChange:(s,t)=>l("typeProduit",t),disablePortal:!0,options:w,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:n["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(j,{value:o.categorieProduit,className:"w-full",onChange:(s,t)=>l("categorieProduit",t),disablePortal:!0,options:P,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:n["data.categorieProduit"]})]})]})}),e.jsxs(k,{children:[e.jsx(i,{variant:"contained",color:"error",onClick:L,children:"Annuler"}),e.jsx(i,{variant:"contained",color:"success",onClick:ce,children:"Enregistrer"})]})]}),e.jsxs(g,{open:ae,onClose:le,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Details du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:o.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(_=o.typeProduit)==null?void 0:_.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CATEGORIE"}),e.jsx("div",{className:"py-2 px-2",children:(q=o.categorieProduit)==null?void 0:q.nom})]})]})})]}),e.jsxs(g,{open:oe,onClose:M,children:[e.jsx(h,{className:"bg-orange-600 text-white",children:"Suppression du produit"}),e.jsx(x,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[o.message==="delete"&&"Voulez-vous vraiment suspendre ce produit",o.message==="check"&&"Voulez-vous vraiment débloquer ce produit"]})}),e.jsxs(k,{children:[e.jsxs(i,{variant:"contained",color:"error",onClick:M,children:[e.jsx(je,{}),"  Non"]}),e.jsxs(i,{variant:"contained",color:"success",onClick:ue,children:[e.jsx(B,{})," Oui"]})]})]})]}),e.jsx(fe,{table:pe})]})})}export{Me as default};
