import{r as a,W as ge,j as e,y as S}from"./app-eb4ac14d.js";import{P as he}from"./PanelLayout-9db7ade9.js";/* empty css            */import{u as xe,M as fe}from"./index.esm-c4a53501.js";import{M as je}from"./index.esm-4bae7fd4.js";import{I as d}from"./InputError-72dd93fb.js";import{B as o}from"./Button-7f8b9a63.js";import{V as Ce}from"./Visibility-c9cb56b1.js";import{E as be}from"./Edit-9517b33c.js";import{D as ve}from"./Delete-98ed2789.js";import{C as W}from"./Check-b85e105e.js";import{A as ye}from"./AddCircle-9c227046.js";import{D as g,a as h,b as w}from"./DialogContent-a8b90f31.js";import{D as x}from"./DialogTitle-7e680bb7.js";import{T as c}from"./TextField-22f70a44.js";import{A as f}from"./Autocomplete-7942bf2c.js";import{C as Ne}from"./Close-7d5020eb.js";import"./createSvgIcon-4d9a41bc.js";import"./index-cf4ee6ec.js";import"./Dropdown-8c28aa27.js";import"./transition-a13fe195.js";import"./Cancel-8205af54.js";import"./Edit-17e2fc58.js";import"./TableRow-9f6508f6.js";import"./Popper-1f680820.js";import"./MenuItem-3d0941cb.js";import"./DatePicker-25bc8498.js";import"./Chip-bb44338a.js";import"./LastPage-4e97b798.js";import"./SwitchBase-3ba62cb7.js";import"./Checkbox-ae5cc143.js";import"./Stack-ebf23453.js";import"./CircularProgress-c9ab41e4.js";import"./Switch-31212aee.js";function is({auth:m,errors:l,produits:u,typeProduits:P,categories:E,error:A,success:q}){var _,B;const[G,F]=a.useState([]),[k,I]=a.useState(!1),[U,j]=a.useState(!1),[Y,p]=a.useState(!1),[H,O]=a.useState(0),[C,J]=a.useState([]),[b,Q]=a.useState(""),[v,X]=a.useState([]),[n,Z]=a.useState({pageIndex:u.current_page-1,pageSize:u.per_page});a.useEffect(()=>{O(u.total),F(u.data),p(!1)},[u]),a.useEffect(()=>{p(!0),j(!0),axios.post(route("admin.produit.paginationFiltre"),{start:n.pageIndex*n.pageSize,size:n.pageSize,filters:C??[],globalFilter:b??"",sorting:v??[]}).then(s=>{F(s.data.data),O(s.data.rowCount),j(!1),p(!1)}).catch(s=>{I(!0),console.error(A)}),I(!1),j(!1),p(!1)},[C,b,n.pageIndex,n.pageSize,v]);const{data:i,setData:r,post:$,put:ee,reset:y}=ge({id:"",nom:"",typeProduit:null,categorie:null}),[se,N]=a.useState(!1),[te,T]=a.useState(!1),[ae,D]=a.useState(!1),[ie,z]=a.useState(!1),oe=()=>{S.get(route("admin.produit.create",m.user.id),{onSuccess:()=>y()})},R=()=>{N(!1)},V=()=>{T(!1)},re=()=>{D(!1)},K=()=>{z(!1)},L=s=>{s.target.type==="checkbox"?r(s.target.name,s.target.checked):r(s.target.name,s.target.value)},le=()=>{$(route("superAdmin.produit.store"),{onSuccess:()=>{y(),N(!1)}})},ne=s=>{S.get(route("admin.produit.edit",[m.user.id,s.id]),{preserveScroll:!0})},de=s=>{r({id:s.id,nom:s.nom||"",typeProduit:s.type_souscripteur||null,categorie:s.categorie_souscripteur||null}),D(!0)},M=(s,t)=>{r({id:s,message:t}),z(!0)},ce=()=>{ee(route("superAdmin.produit.update",i.id),{onSuccess:()=>{y(),T(!1)}})},ue=()=>{N(!1),S.delete(route("superAdmin.produit.destroy",{id:i.id}))},me=a.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"prixAchat",header:"Prix de vente"},{accessorKey:"prixVente",header:"Prix d'achat"},{accessorKey:"typeProduit",header:"Type",Cell:({row:s})=>{var t;return(t=s.original.type_produit)==null?void 0:t.libelle}},{accessorKey:"categorie",header:"Categorie",Cell:({row:s})=>{var t;return(t=s.original.categorie)==null?void 0:t.libelle}},{accessorKey:"fournisseurPrincipal",header:"Fournisseur principal",Cell:({row:s})=>{var t;return(t=s.original.fournisseur_principal)==null?void 0:t.nom}},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>de(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(Ce,{})}),e.jsx(o,{onClick:()=>ne(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(be,{})}),s.original.status?e.jsx(o,{onClick:()=>M(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(ve,{})}):e.jsx(o,{onClick:()=>M(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(W,{})})]},s.original.id)}],[]),pe=xe({columns:me,data:G,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:k?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:J,onGlobalFilterChange:Q,onPaginationChange:Z,onSortingChange:X,rowCount:H,state:{columnFilters:C,globalFilter:b,isLoading:U,pagination:n,showAlertBanner:k,showProgressBars:Y,sorting:v},localization:je});return e.jsx(he,{auth:m,success:q,error:A,errors:l,active:"catalogue",sousActive:"produit",breadcrumbs:[{text:"Produit",href:route("admin.produit.index",[m.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(o,{color:"warning",variant:"contained",onClick:oe,children:[e.jsx(ye,{className:"mr-1"})," Ajout produit"]}),e.jsxs(g,{open:se,onClose:R,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Ajout du produit"}),e.jsx(h,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:i.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:L}),e.jsx(d,{message:l.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(f,{className:"w-full",onChange:(s,t)=>r("typeProduit",t),disablePortal:!0,options:P,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:l["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(f,{className:"w-full",onChange:(s,t)=>r("categorie",t),disablePortal:!0,options:E,groupBy:s=>s.categorie.libelle,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:l["data.categorie"]})]})]})}),e.jsxs(w,{children:[e.jsx(o,{variant:"contained",color:"error",onClick:R,children:"Annuler"}),e.jsx(o,{variant:"contained",color:"success",onClick:le,children:"Enregistrer"})]})]}),e.jsxs(g,{open:te,onClose:V,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Modification du produit"}),e.jsx(h,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(c,{value:i.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:L}),e.jsx(d,{message:l.nom,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(f,{value:i.typeProduit,className:"w-full",onChange:(s,t)=>r("typeProduit",t),disablePortal:!0,options:P,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Type de produit",label:s.nom})}),e.jsx(d,{message:l["data.typeProduit"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(f,{value:i.categorie,className:"w-full",onChange:(s,t)=>r("categorie",t),disablePortal:!0,options:E,groupBy:s=>s.categorie.libelle,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,t)=>s.id===t.id,renderInput:s=>e.jsx(c,{fullWidth:!0,...s,placeholder:"Catégorie de produit",label:s.nom})}),e.jsx(d,{message:l["data.categorie"]})]})]})}),e.jsxs(w,{children:[e.jsx(o,{variant:"contained",color:"error",onClick:V,children:"Annuler"}),e.jsx(o,{variant:"contained",color:"success",onClick:ce,children:"Enregistrer"})]})]}),e.jsxs(g,{open:ae,onClose:re,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Details du produit"}),e.jsx(h,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:i.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(_=i.typeProduit)==null?void 0:_.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CATEGORIE"}),e.jsx("div",{className:"py-2 px-2",children:(B=i.categorie)==null?void 0:B.nom})]})]})})]}),e.jsxs(g,{open:ie,onClose:K,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Suppression du produit"}),e.jsx(h,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[i.message==="delete"&&"Voulez-vous vraiment suspendre ce produit",i.message==="check"&&"Voulez-vous vraiment débloquer ce produit"]})}),e.jsxs(w,{children:[e.jsxs(o,{variant:"contained",color:"error",onClick:K,children:[e.jsx(Ne,{}),"  Non"]}),e.jsxs(o,{variant:"contained",color:"success",onClick:ue,children:[e.jsx(W,{})," Oui"]})]})]})]}),e.jsx(fe,{table:pe})]})})}export{is as default};
