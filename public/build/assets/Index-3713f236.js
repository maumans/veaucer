import{r as o,W as pe,j as e,y as je}from"./app-2375f243.js";import{f as K}from"./PanelLayout-e7050e06.js";import{R as fe}from"./ReferentielLayout-7339f89f.js";import{u as Ne,D as p,a as j,b as f,e as N,c as A,C as ve,M as be}from"./index.esm-24e1cabb.js";import{V as Ce,E as we,D as Se,C as B,A as ye,M as Ae}from"./index.esm-858d862c.js";import{I as n}from"./InputError-68d6cb0c.js";import{B as c}from"./Button-360edc97.js";import{T as i,A as m}from"./TextField-5b383e78.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";/* empty css            */import"./Search-d7112b9b.js";function Ve({auth:E,errors:t,referentiels:G,adherents:h,souscripteurs:D,contrats:F,liens:O,error:I,success:_}){var J;const[U,k]=o.useState([]),[W,q]=o.useState(!1),[H,v]=o.useState(!1),[Q,x]=o.useState(!1),[X,P]=o.useState(0),[b,Y]=o.useState([]),[C,Z]=o.useState(""),[w,$]=o.useState([]),[u,ee]=o.useState({pageIndex:h.current_page-1,pageSize:h.per_page});o.useEffect(()=>{P(h.total),k(h.data),x(!1)},[h]),o.useEffect(()=>{x(!0),v(!0),axios.post(route("superAdmin.adherent.paginationFiltre"),{start:u.pageIndex*u.pageSize,size:u.pageSize,filters:b??[],globalFilter:C??"",sorting:w??[]}).then(s=>{k(s.data.data),P(s.data.rowCount),v(!1),x(!1)}).catch(s=>{q(!0),console.error(I)}),q(!1),v(!1),x(!1)},[b,C,u.pageIndex,u.pageSize,w]);const{data:a,setData:r,post:se,put:ae,reset:S}=pe({id:"",nom:"",code:"",lieuNaissance:"",dateNaissance:K(new Date(Date.now()),"yyyy/MM/dd"),dateAdhesion:K(new Date(Date.now()),"yyyy/MM/dd"),validiteSpecifique:!1,nombreJours:"",slug:"",souscripteur:null,contrat:null,lien:null}),[le,g]=o.useState(!1),[te,y]=o.useState(!1),[ne,L]=o.useState(!1),[ie,R]=o.useState(!1),oe=()=>{S(),g(!0)},T=()=>{g(!1)},z=()=>{y(!1)},re=()=>{L(!1)},M=()=>{R(!1)},d=s=>{s.target.type==="checkbox"?r(s.target.name,s.target.checked):r(s.target.name,s.target.value)},de=()=>{se(route("superAdmin.adherent.store"),{onSuccess:()=>{S(),g(!1)}})},ce=s=>{r({id:s.id,nom:s.nom||"",code:s.code||"",lieuNaissance:s.lieuNaissance||"",dateNaissance:s.dateNaissance||"",dateAdhesion:s.dateAdhesion||"",validiteSpecifique:!!s.validiteSpecifique||!1,nombreJours:s.nombreJours||"",slug:s.slug||"",souscripteur:s.souscripteur||null,contrat:s.contrat||null,lien:s.lien||null}),y(!0)},ue=s=>{r({id:s.id,nom:s.nom||"",code:s.code||"",validiteSpecifique:!!s.validiteSpecifique||!1,nombreJours:s.nombreJours||"",slug:s.slug||"",souscripteur:s.souscripteur||null,contrat:s.contrat||null,lien:s.lien||null}),L(!0)},V=(s,l)=>{r({id:s,message:l}),R(!0)},me=()=>{ae(route("superAdmin.adherent.update",a.id),{onSuccess:()=>{S(),y(!1)}})},he=()=>{g(!1),je.delete(route("superAdmin.adherent.destroy",{id:a.id}))},xe=o.useMemo(()=>[{accessorKey:"prenom",header:"Prenom"},{accessorKey:"carte",header:"N° carte"},{accessorKey:"code",header:"Code"},{accessorKey:"souscripteur",header:"Souscripteur",Cell:({row:s})=>{var l;return(l=s.original.souscripteur)==null?void 0:l.libelle}},{accessorKey:"lien",header:"Lien",Cell:({row:s})=>{var l;return(l=s.original.lien)==null?void 0:l.nom}},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{onClick:()=>ue(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(Ce,{})}),e.jsx(c,{onClick:()=>ce(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(we,{})}),s.original.status?e.jsx(c,{onClick:()=>V(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(Se,{})}):e.jsx(c,{onClick:()=>V(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(B,{})})]},s.original.id)}],[]),ge=Ne({columns:xe,data:U,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:W?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:Y,onGlobalFilterChange:Z,onPaginationChange:ee,onSortingChange:$,rowCount:X,state:{columnFilters:b,globalFilter:C,isLoading:H,pagination:u,showAlertBanner:W,showProgressBars:Q,sorting:w},localization:Ae});return e.jsx(fe,{success:_,error:I,auth:E,errors:t,referentiels:G,referentiel:"Adherents",active:"referentiel",sousActive:"superAdmin.adherent.index",breadcrumbs:[{text:"Adhérent",href:route("superAdmin.adherent.index",[E.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(c,{color:"warning",variant:"contained",onClick:oe,children:[e.jsx(ye,{className:"mr-1"})," Ajout adherent"]}),e.jsxs(p,{open:le,onClose:T,children:[e.jsx(j,{className:"bg-orange-600 text-white",children:"Ajout de l'adherent"}),e.jsx(f,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"prenom",name:"prenom",label:"Prenom",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.prenom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"sexe",name:"sexe",label:"Sexe",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.sexe,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.carte,id:"carte",name:"carte",label:"Carte",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.carte,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"w-full",value:a.dateNaissance,label:"Date de naissance",slots:{textField:s=>e.jsx(i,{...s})},onChange:s=>r("dateNaissance",s),required:!0}),e.jsx(n,{message:t.dateNaissance,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.lieuNaissance,id:"lieuNaissance",name:"lieuNaissance",label:"Lieu de naissance",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.lieuNaissance,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"w-full",value:a.dateAdhesion,label:"Date d'adhésion",slots:{textField:s=>e.jsx(i,{...s})},onChange:s=>r("dateAdhesion",s),required:!0}),e.jsx(n,{message:t.dateAdhesion,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.souscripteur,className:"w-full",onChange:(s,l)=>r("souscripteur",l),disablePortal:!0,options:D,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"Garantie",label:s.nom})}),e.jsx(n,{message:t["data.souscripteur"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.lien,className:"w-full",onChange:(s,l)=>r("lien",l),disablePortal:!0,options:O,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"lien",label:s.nom})}),e.jsx(n,{message:t["data.lien"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.contrat,className:"w-full",onChange:(s,l)=>r("contrat",l),disablePortal:!0,options:F,getOptionLabel:s=>s.mouvement,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"Contrat",label:s.mouvement})}),e.jsx(n,{message:t["data.contrat"]})]})]})}),e.jsxs(A,{children:[e.jsx(c,{variant:"contained",color:"error",onClick:T,children:"Annuler"}),e.jsx(c,{variant:"contained",color:"success",onClick:de,children:"Enregistrer"})]})]}),e.jsxs(p,{open:te,onClose:z,children:[e.jsx(j,{className:"bg-orange-600 text-white",children:"Modification de l'adherent"}),e.jsx(f,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"prenom",name:"prenom",label:"Prenom",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.prenom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.nom,autoFocus:!0,id:"sexe",name:"sexe",label:"Sexe",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.sexe,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.carte,id:"carte",name:"carte",label:"Carte",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.carte,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"w-full",value:a.dateNaissance,label:"Date de naissance",renderInput:s=>e.jsx(i,{...s}),onChange:s=>r("dateNaissance",s),required:!0}),e.jsx(n,{message:t.dateNaissance,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.lieuNaissance,id:"lieuNaissance",name:"lieuNaissance",label:"Lieu de naissance",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.lieuNaissance,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"w-full",value:a.dateAdhesion,label:"Date d'incorporation souhaitée",renderInput:s=>e.jsx(i,{...s}),onChange:s=>r("dateAdhesion",s),required:!0}),e.jsx(n,{message:t.dateAdhesion,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:a.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:d}),e.jsx(n,{message:t.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.souscripteur,className:"w-full",onChange:(s,l)=>r("souscripteur",l),disablePortal:!0,options:D,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"Garantie",label:s.nom})}),e.jsx(n,{message:t["data.souscripteur"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.lien,className:"w-full",onChange:(s,l)=>r("lien",l),disablePortal:!0,options:O,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"lien",label:s.nom})}),e.jsx(n,{message:t["data.lien"]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{value:a.contrat,className:"w-full",onChange:(s,l)=>r("contrat",l),disablePortal:!0,options:F,getOptionLabel:s=>s.mouvement,isOptionEqualToValue:(s,l)=>s.id===l.id,renderInput:s=>e.jsx(i,{fullWidth:!0,...s,placeholder:"Contrat",label:s.mouvement})}),e.jsx(n,{message:t["data.contrat"]})]})]})}),e.jsxs(A,{children:[e.jsx(c,{variant:"contained",color:"error",onClick:z,children:"Annuler"}),e.jsx(c,{variant:"contained",color:"success",onClick:me,children:"Enregistrer"})]})]}),e.jsxs(p,{open:ne,onClose:re,children:[e.jsx(j,{className:"bg-orange-600 text-white",children:"Details de l'adherent"}),e.jsx(f,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fi",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:a.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"CODE"}),e.jsx("div",{className:"py-2 px-2",children:a.code})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"SLUG"}),e.jsx("div",{className:"py-2 px-2",children:a.slug})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"GARANTIE"}),e.jsx("div",{className:"py-2 px-2",children:(J=a.souscripteur)==null?void 0:J.nom})]}),a.nombreJours&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOMBRE DE JOURS"}),e.jsx("div",{className:"py-2 px-2",children:a.nombreJours})]})]})})]}),e.jsxs(p,{open:ie,onClose:M,children:[e.jsx(j,{className:"bg-orange-600 text-white",children:"Suppression du adherent"}),e.jsx(f,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[a.message==="delete"&&"Voulez-vous vraiment suspendre cet adherent",a.message==="check"&&"Voulez-vous vraiment débloquer cet adherent"]})}),e.jsxs(A,{children:[e.jsxs(c,{variant:"contained",color:"error",onClick:M,children:[e.jsx(ve,{}),"  Non"]}),e.jsxs(c,{variant:"contained",color:"success",onClick:he,children:[e.jsx(B,{})," Oui"]})]})]})]}),e.jsx(be,{table:ge})]})})}export{Ve as default};
