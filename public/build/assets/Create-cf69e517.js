import{r as c,W as I,j as e,y as W}from"./app-4edf48e5.js";import{P as B,a as F,T as N,B as G}from"./PanelLayout-f2722d4d.js";import{G as i}from"./Grid-7a3a83b6.js";import{A as L}from"./Autocomplete-296c4901.js";import{T as o,F as M,I as E,S as O,b as H}from"./TextField-552e66ea.js";import{M as j}from"./MenuItem-b79354fa.js";import{B as v}from"./Button-287e2751.js";import"./createSvgIcon-5bc31cb8.js";import"./index-17fa150b.js";import"./Dropdown-4c3aabf3.js";import"./transition-92123e1c.js";import"./Popper-aabbbbc2.js";import"./Chip-0001e9bb.js";const te=({auth:s,produits:f,departements:b,success:g,error:_})=>{const[u,p]=c.useState(null),[S,d]=c.useState(0),[k,C]=c.useState(""),{data:l,setData:a,post:y,processing:q,errors:n}=I({produit_id:"",quantite_apres:"",motif:"",departement_id:"",notes:""}),D=(t,r)=>{r?(p(r),x(r,k),a("produit_id",r.id)):(p(null),d(0),a("produit_id",""))},P=t=>{const r=t.target.value;C(r),a("departement_id",r),u&&x(u,r)},x=(t,r)=>{var h;if(t){if(r){const m=(h=t.stocks)==null?void 0:h.find(A=>A.departement_id==r);console.log("Stock département trouvé:",m),d(m?m.quantite:0)}else d(t.stockGlobal||0);console.log("Produit:",t),console.log("Département ID:",r),console.log("Stocks disponibles:",t.stocks)}},T=t=>{t.preventDefault(),y(route("admin.inventaire.ajustement.store",s.user.id))};return e.jsx(B,{auth:s,success:g,error:_,active:"stock",sousActive:"inventaire",breadcrumbs:[{text:"Inventaire",href:route("admin.stock.inventaire.index",[s.user.id]),active:!1},{text:"Ajustements d'inventaire",href:route("admin.inventaire.ajustement.index",[s.user.id]),active:!1},{text:"Nouvel ajustement",href:route("admin.inventaire.ajustement.create",[s.user.id]),active:!0}],children:e.jsxs(F,{elevation:3,className:"p-6",children:[e.jsx(N,{variant:"h5",component:"h1",gutterBottom:!0,children:"Créer un nouvel ajustement d'inventaire"}),e.jsx("form",{onSubmit:T,children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(L,{options:f,getOptionLabel:t=>t.nom,value:u,onChange:D,renderInput:t=>e.jsx(o,{...t,label:"Produit",error:!!n.produit_id,helperText:n.produit_id,fullWidth:!0,required:!0})})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsxs(M,{fullWidth:!0,children:[e.jsx(E,{id:"departement-label",children:"Département"}),e.jsxs(O,{labelId:"departement-label",value:l.departement_id,onChange:P,label:"Département (optionnel)",error:!!n.departement_id,children:[e.jsx(j,{value:"",children:e.jsx("em",{children:"Stock global (tous les départements)"})}),b.map(t=>e.jsx(j,{value:t.id,children:t.nom},t.id))]}),n.departement_id&&e.jsx(H,{error:!0,children:n.departement_id})]})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(o,{label:"Quantité actuelle",value:S,fullWidth:!0,disabled:!0,InputProps:{readOnly:!0}})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(o,{label:"Nouvelle quantité",type:"number",fullWidth:!0,required:!0,value:l.quantite_apres,onChange:t=>a("quantite_apres",t.target.value),error:!!n.quantite_apres,helperText:n.quantite_apres,inputProps:{min:0}})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(o,{label:"Motif de l'ajustement",fullWidth:!0,required:!0,value:l.motif,onChange:t=>a("motif",t.target.value),error:!!n.motif,helperText:n.motif})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(o,{label:"Notes additionnelles",multiline:!0,rows:4,fullWidth:!0,value:l.notes,onChange:t=>a("notes",t.target.value),error:!!n.notes,helperText:n.notes})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(G,{display:"flex",justifyContent:"flex-end",gap:2,children:[e.jsx(v,{variant:"outlined",onClick:()=>W.get(route("admin.inventaire.ajustement.index",s.user.id)),children:"Annuler"}),e.jsx(v,{type:"submit",variant:"contained",color:"primary",disabled:q,children:"Créer l'ajustement"})]})})]})})]})})};export{te as default};
