import{r as a,W as me,j as e,y as ge}from"./app-2375f243.js";import"./PanelLayout-e7050e06.js";import{R as pe}from"./ReferentielLayout-7339f89f.js";import{u as he,D as h,a as x,b as j,c as S,C as xe,M as je}from"./index.esm-24e1cabb.js";import{V as fe,E as ve,D as Ce,C as W,A as be,M as ye}from"./index.esm-858d862c.js";import{I as c}from"./InputError-68d6cb0c.js";import{B as l}from"./Button-360edc97.js";import{T as d,A as _}from"./TextField-5b383e78.js";import"./createSvgIcon-ab9be74c.js";import"./index-c926b602.js";import"./Dropdown-1ce9c365.js";import"./transition-d812106d.js";/* empty css            */import"./Search-d7112b9b.js";function Me({auth:w,errors:n,referentiels:V,prestataires:u,typesPrestataires:A,error:E,success:B}){var L;const[K,P]=a.useState([]),[k,F]=a.useState(!1),[q,f]=a.useState(!1),[G,m]=a.useState(!1),[U,z]=a.useState(0),[v,Y]=a.useState([]),[C,H]=a.useState(""),[b,J]=a.useState([]),[o,Q]=a.useState({pageIndex:u.current_page-1,pageSize:u.per_page});a.useEffect(()=>{z(u.total),P(u.data),m(!1)},[u]),a.useEffect(()=>{m(!0),f(!0),axios.post(route("superAdmin.prestataire.paginationFiltre"),{start:o.pageIndex*o.pageSize,size:o.pageSize,filters:v??[],globalFilter:C??"",sorting:b??[]}).then(s=>{P(s.data.data),z(s.data.rowCount),f(!1),m(!1)}).catch(s=>{F(!0),console.error(E)}),F(!1),f(!1),m(!1)},[v,C,o.pageIndex,o.pageSize,b]);const{data:t,setData:r,post:X,put:Z,reset:y}=me({id:"",nom:"",slug:"",typePrestataire:null}),[$,g]=a.useState(!1),[ee,N]=a.useState(!1),[se,D]=a.useState(!1),[ae,I]=a.useState(!1),te=()=>{y(),g(!0)},T=()=>{g(!1)},O=()=>{N(!1)},ie=()=>{D(!1)},R=()=>{I(!1)},p=s=>{s.target.type==="checkbox"?r(s.target.name,s.target.checked):r(s.target.name,s.target.value)},le=()=>{X(route("superAdmin.prestataire.store"),{onSuccess:()=>{y(),g(!1)}})},ne=s=>{r({id:s.id,nom:s.nom||"",slug:s.slug||"",typePrestataire:s.type_souscripteur||null}),N(!0)},re=s=>{r({id:s.id,nom:s.nom||"",slug:s.slug||"",typePrestataire:s.type_souscripteur||null}),D(!0)},M=(s,i)=>{r({id:s,message:i}),I(!0)},oe=()=>{Z(route("superAdmin.prestataire.update",t.id),{onSuccess:()=>{y(),N(!1)}})},ce=()=>{g(!1),ge.delete(route("superAdmin.prestataire.destroy",{id:t.id}))},de=a.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"slug",header:"Slug"},{accessorKey:"typePrestataire",header:"Type prestataire",Cell:({row:s})=>{var i;return(i=s.original.type_prestataire)==null?void 0:i.nom}},{accessorKey:"status",header:"Status",Cell:({row:s})=>s.original.status?e.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):e.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",Cell:({row:s})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:()=>re(s.original),variant:"contained",size:"small",color:"info",children:e.jsx(fe,{})}),e.jsx(l,{onClick:()=>ne(s.original),variant:"contained",size:"small",color:"secondary",children:e.jsx(ve,{})}),s.original.status?e.jsx(l,{onClick:()=>M(s.original.id,"delete"),variant:"contained",size:"small",color:"error",children:e.jsx(Ce,{})}):e.jsx(l,{onClick:()=>M(s.original.id,"check"),variant:"contained",size:"small",color:"success",children:e.jsx(W,{})})]},s.original.id)}],[]),ue=he({columns:de,data:K,getRowId:s=>s.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:k?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:Y,onGlobalFilterChange:H,onPaginationChange:Q,onSortingChange:J,rowCount:U,state:{columnFilters:v,globalFilter:C,isLoading:q,pagination:o,showAlertBanner:k,showProgressBars:G,sorting:b},localization:ye});return e.jsx(pe,{success:B,error:E,auth:w,errors:n,referentiels:V,referentiel:"Prestataires",active:"referentiel",sousActive:"superAdmin.prestataire.index",breadcrumbs:[{text:"Prestataire",href:route("superAdmin.prestataire.index",[w.user.id]),active:!1}],children:e.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(l,{color:"warning",variant:"contained",onClick:te,children:[e.jsx(be,{className:"mr-1"})," Ajout prestataire"]}),e.jsxs(h,{open:$,onClose:T,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Ajout du prestataire"}),e.jsx(j,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(d,{value:t.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:p}),e.jsx(c,{message:n.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{value:t.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:p}),e.jsx(c,{message:n.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(_,{className:"w-full",onChange:(s,i)=>r("typePrestataire",i),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,i)=>s.id===i.id,renderInput:s=>e.jsx(d,{fullWidth:!0,...s,placeholder:"Type de prestataire",label:s.nom})}),e.jsx(c,{message:n["data.typePrestataire"]})]})]})}),e.jsxs(S,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:T,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:le,children:"Enregistrer"})]})]}),e.jsxs(h,{open:ee,onClose:O,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Modification du prestataire"}),e.jsx(j,{className:"space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[e.jsxs("div",{children:[e.jsx(d,{value:t.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:p}),e.jsx(c,{message:n.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{value:t.slug,id:"slug",name:"slug",label:"Slug",className:"bg-white",fullWidth:!0,onChange:p}),e.jsx(c,{message:n.slug,className:"mt-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(_,{value:t.typePrestataire,className:"w-full",onChange:(s,i)=>r("typePrestataire",i),disablePortal:!0,options:A,getOptionLabel:s=>s.nom,isOptionEqualToValue:(s,i)=>s.id===i.id,renderInput:s=>e.jsx(d,{fullWidth:!0,...s,placeholder:"Type de prestataire",label:s.nom})}),e.jsx(c,{message:n["data.typePrestataire"]})]})]})}),e.jsxs(S,{children:[e.jsx(l,{variant:"contained",color:"error",onClick:O,children:"Annuler"}),e.jsx(l,{variant:"contained",color:"success",onClick:oe,children:"Enregistrer"})]})]}),e.jsxs(h,{open:se,onClose:ie,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Details du prestataire"}),e.jsx(j,{className:"space-y-5",children:e.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fi",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),e.jsx("div",{className:"py-2 px-2",children:t.nom})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"SLUG"}),e.jsx("div",{className:"py-2 px-2",children:t.slug})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),e.jsx("div",{className:"py-2 px-2",children:(L=t.typeSouscripteur)==null?void 0:L.nom})]})]})})]}),e.jsxs(h,{open:ae,onClose:R,children:[e.jsx(x,{className:"bg-orange-600 text-white",children:"Suppression du prestataire"}),e.jsx(j,{className:"space-y-5",children:e.jsxs("div",{className:"mt-5",children:[t.message==="delete"&&"Voulez-vous vraiment suspendre ce prestataire",t.message==="check"&&"Voulez-vous vraiment d√©bloquer ce prestataire"]})}),e.jsxs(S,{children:[e.jsxs(l,{variant:"contained",color:"error",onClick:R,children:[e.jsx(xe,{}),"  Non"]}),e.jsxs(l,{variant:"contained",color:"success",onClick:ce,children:[e.jsx(W,{})," Oui"]})]})]})]}),e.jsx(je,{table:ue})]})})}export{Me as default};
