import{r as o,W as ce,j as s,y as R}from"./app-ef847769.js";import{P as de}from"./PanelLayout-f3b1b528.js";/* empty css            */import{u as me,M as pe}from"./index.esm-f651ad8d.js";import{M as ue}from"./index.esm-4bae7fd4.js";import{I as n}from"./InputError-101e4114.js";import{B as p}from"./Button-5cd339f2.js";import{A as ge}from"./AddCircle-aaca1f2f.js";import{D as y,a as S,b as O}from"./DialogContent-21eccb4c.js";import{D as b}from"./DialogTitle-8810badb.js";import{T as c,a as he}from"./TextField-239b9d80.js";import{A as xe}from"./Autocomplete-e3bbac74.js";import{C as fe}from"./Close-a9dab803.js";import{C as W}from"./Check-a16d6a02.js";import{V as je}from"./Visibility-4a9b5128.js";import{E as Ce}from"./Edit-56c024d5.js";import{D as ve}from"./Delete-578fe21d.js";import"./createSvgIcon-1d15f18d.js";import"./index-63345e99.js";import"./Dropdown-acf677e6.js";import"./transition-07c41afc.js";import"./Cancel-055cb859.js";import"./Edit-ed1cfcc7.js";import"./TableRow-e01d0199.js";import"./Popper-fafd03d0.js";import"./MenuItem-7e314da3.js";import"./DatePicker-17c52b79.js";import"./Chip-7ba2869a.js";import"./LastPage-9a697fd0.js";import"./SwitchBase-300b33a4.js";import"./Checkbox-29e5b734.js";import"./Stack-d9f7e61f.js";import"./CircularProgress-9e4a82bd.js";import"./Switch-00012cca.js";function os({auth:a,errors:l,referentiels:ye,societes:u,typeSocietes:K,error:N,success:L}){var I,z;const[_,w]=o.useState([]),[A,M]=o.useState(!1),[B,h]=o.useState(!1),[V,g]=o.useState(!1),[G,D]=o.useState(0),[x,U]=o.useState([]),[f,q]=o.useState(""),[j,Y]=o.useState([]),[d,H]=o.useState({pageIndex:u.current_page-1,pageSize:u.per_page});o.useEffect(()=>{D(u.total),w(u.data),g(!1)},[u]),o.useEffect(()=>{g(!0),h(!0),axios.post(route("superAdmin.societe.paginationFiltre",a.user.id),{start:d.pageIndex*d.pageSize,size:d.pageSize,filters:x??[],globalFilter:f??"",sorting:j??[]}).then(e=>{w(e.data.data),D(e.data.rowCount),h(!1),g(!1)}).catch(e=>{M(!0),console.error(N)}),M(!1),h(!1),g(!1)},[x,f,d.pageIndex,d.pageSize,j]);const{data:i,setData:m,post:Se,put:J,reset:E}=ce({id:"",nom:"",telephone1:"",telephone2:"",adresseMail:"",description:"",logo:"",typeSociete:null});o.useState(!1);const[Q,C]=o.useState(!1),[X,F]=o.useState(!1),[Z,v]=o.useState(!1),$=()=>{R.get(route("superAdmin.societe.create",a.user.id),{onSuccess:()=>E()})},k=()=>{C(!1)},ee=()=>{F(!1)},T=()=>{v(!1)},r=e=>{e.target.type==="checkbox"?m(e.target.name,e.target.checked):m(e.target.name,e.target.value)},se=e=>{m({id:e.id,nom:e.nom||"",adresse:e.adresse||"",telephone1:e.telephone1||"",telephone2:e.telephone2||"",adresseMail:e.adresseMail||"",description:e.description||"",logo:e.logo||"",slug:e.slug||"",typeSociete:e.type_societe||null}),C(!0)},te=e=>{m({id:e.id,nom:e.nom||"",telephone1:e.telephone1||"",telephone2:e.telephone2||"",adresseMail:e.adresseMail||"",description:e.description||"",logo:e.logo||"",slug:e.slug||"",typeSociete:e.type_societe||null}),F(!0)},oe=(e,t)=>{m({id:e,message:t}),v(!0)},ie=()=>{J(route("superAdmin.societe.update",{userId:a.user.id,id:i.id}),{onSuccess:()=>{E(),C(!1)}})},ae=()=>{R.delete(route("superAdmin.societe.destroy",[a.user.slug,i.id]),{onSuccess:()=>v(!1)})},le=[{permission:"show-societes",condition:e=>!0,title:"Détails",color:"secondary",icon:s.jsx(je,{}),onClick:e=>te(e.original.slug)},{permission:"edit-societes",condition:e=>!0,title:"Modifier",color:"info",icon:s.jsx(Ce,{}),onClick:e=>se(e.original.slug)},{permission:"delete-societes",condition:e=>!0,title:e=>e.original.status?"Suspendre":"Activer",color:e=>e.original.status?"error":"success",icon:e=>e.original.status?s.jsx(ve,{}):s.jsx(W,{}),onClick:e=>oe(e.original.slug,e.original.status?"delete":"check")}],ne=o.useMemo(()=>[{accessorKey:"nom",header:"Nom"},{accessorKey:"typeSociete",header:"Type societe",Cell:({row:e})=>{var t;return(t=e.original.type_societe)==null?void 0:t.nom}},{accessorKey:"adresse",header:"Adresse"},{accessorKey:"description",header:"Description"},{accessorKey:"logo",header:"Logo"},{accessorKey:"status",header:"Status",Cell:({row:e})=>e.original.status?s.jsx("div",{className:"p-2 font-bold bg-green-500 text-white w-fit h-fit rounded",children:"Actif"}):s.jsx("div",{className:"p-2 font-bold bg-red-500 text-white w-fit h-fit rounded",children:"Inactif"})},{accessorKey:"action",header:"Action",enableColumnFilter:!1,Cell:({row:e})=>s.jsx("div",{className:"flex gap-2",children:le.map(t=>{var P;return((P=a==null?void 0:a.permissions)==null?void 0:P.includes(t.permission))&&t.condition(e)&&s.jsx(p,{title:typeof t.title=="function"?t.title(e):t.title,onClick:()=>t.onClick(e),variant:"outlined",size:"small",color:typeof t.color=="function"?t.color(e):t.color,children:typeof t.icon=="function"?t.icon(e):t.icon},t.permission)})},e.original.id)}],[]),re=me({columns:ne,data:_,getRowId:e=>e.id,initialState:{showColumnFilters:!1},manualFiltering:!0,manualPagination:!0,manualSorting:!0,muiToolbarAlertBannerProps:A?{color:"error",children:"Error loading data"}:void 0,onColumnFiltersChange:U,onGlobalFilterChange:q,onPaginationChange:H,onSortingChange:Y,rowCount:G,state:{columnFilters:x,globalFilter:f,isLoading:B,pagination:d,showAlertBanner:A,showProgressBars:V,sorting:j},localization:ue});return s.jsx(de,{auth:a,success:L,error:N,active:"societe",children:s.jsxs("div",{className:"grid gap-5 bg-gray-200 p-2 rounded border",children:[s.jsxs("div",{className:"flex justify-end",children:[(I=a==null?void 0:a.permissions)!=null&&I.some(e=>e==="create-societes")?s.jsxs(p,{color:"warning",variant:"contained",onClick:$,children:[s.jsx(ge,{className:"mr-1"})," Ajout société"]}):"",s.jsxs(y,{open:Q,onClose:k,children:[s.jsx(b,{className:"bg-orange-600 text-white",children:"Modification de la société"}),s.jsx(S,{className:"space-y-5",children:s.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 bg-gray-50 gap-5 p-2 m-2 rounded",children:[s.jsxs("div",{children:[s.jsx(c,{value:i.nom,autoFocus:!0,id:"nom",name:"nom",label:"Nom",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.nom,className:"mt-2"})]}),s.jsxs("div",{className:"w-full",children:[s.jsx(xe,{value:i.typeSociete,className:"w-full",onChange:(e,t)=>m("typeSociete",t),disablePortal:!0,options:K,getOptionLabel:e=>e.nom,isOptionEqualToValue:(e,t)=>e.id===t.id,renderInput:e=>s.jsx(c,{fullWidth:!0,...e,placeholder:"Type de societe",label:e.nom})}),s.jsx(n,{message:l["data.typeSociete"]})]}),s.jsxs("div",{children:[s.jsx(c,{value:i.adresse,id:"adresse",name:"adresse",label:"Adresse",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.adresse,className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(c,{value:i.telephone1,id:"telephone1",name:"telephone1",label:"Tel",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.telephone1,className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(c,{value:i.telephone2,id:"telephone2",name:"telephone2",label:"Tel 2",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.telephone2,className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(c,{value:i.adresseMail,type:"mail",id:"adresseMail",name:"adresseMail",label:"Adresse mail",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.adresseMail,className:"mt-2"})]}),s.jsxs("div",{className:"col-span-2 mt-8",children:[s.jsx(he,{value:i.description,className:"w-full",name:"description",placeholder:"Description",style:{height:100},onChange:r,autoComplete:"description"}),s.jsx(n,{message:l["data.description"]})]}),s.jsxs("div",{children:[s.jsx(c,{value:i.logo,id:"logo",name:"logo",label:"logo",className:"bg-white",fullWidth:!0,onChange:r}),s.jsx(n,{message:l.logo,className:"mt-2"})]})]})}),s.jsxs(O,{children:[s.jsx(p,{variant:"contained",color:"error",onClick:k,children:"Annuler"}),s.jsx(p,{variant:"contained",color:"success",onClick:ie,children:"Enregistrer"})]})]}),s.jsxs(y,{open:X,onClose:ee,children:[s.jsx(b,{className:"bg-orange-600 text-white",children:"Details du societe"}),s.jsx(S,{className:"space-y-5",children:s.jsxs("div",{className:"grid grid-cols-2 mt-5 divide-y divide-x border w-96 min-w-fit",children:[s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"font-bold py-2 px-2",children:"NOM"}),s.jsx("div",{className:"py-2 px-2",children:i.nom})]}),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"font-bold py-2 px-2",children:"SLUG"}),s.jsx("div",{className:"py-2 px-2",children:i.slug})]}),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"font-bold py-2 px-2",children:"TYPE"}),s.jsx("div",{className:"py-2 px-2",children:(z=i.typeSociete)==null?void 0:z.nom})]})]})})]}),s.jsxs(y,{open:Z,onClose:T,children:[s.jsx(b,{className:"bg-orange-600 text-white",children:"Suppression du societe"}),s.jsx(S,{className:"space-y-5",children:s.jsxs("div",{className:"mt-5",children:[i.message==="delete"&&"Voulez-vous vraiment supprimer cette societe",i.message==="check"&&"Voulez-vous vraiment restaurer cette societe"]})}),s.jsxs(O,{children:[s.jsxs(p,{variant:"contained",color:"error",onClick:T,children:[s.jsx(fe,{}),"  Non"]}),s.jsxs(p,{variant:"contained",color:"success",onClick:ae,children:[s.jsx(W,{})," Oui"]})]})]})]}),s.jsx(pe,{table:re})]})})}export{os as default};
