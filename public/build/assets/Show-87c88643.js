import{r as c,j as e,y as x}from"./app-ef847769.js";import{P as L,a as T,B as o,T as i,D as m,d as F}from"./PanelLayout-f3b1b528.js";import{B as n}from"./Button-5cd339f2.js";import{A as z}from"./ArrowBack-609c6f32.js";import{G as t}from"./Grid-8b166bc4.js";import{C as f,a as p}from"./CardContent-4bc855c4.js";import{C,a as y}from"./CheckCircle-edf3dcba.js";import{D,a as R,b as k}from"./DialogContent-21eccb4c.js";import{D as S}from"./DialogTitle-8810badb.js";import{T as E}from"./TextField-239b9d80.js";import{C as P}from"./Chip-7ba2869a.js";import"./createSvgIcon-1d15f18d.js";import"./index-63345e99.js";import"./Dropdown-acf677e6.js";import"./transition-07c41afc.js";const re=({auth:s,ajustement:r,success:_,error:A})=>{const[w,d]=c.useState(!1),[u,v]=c.useState(""),[b,g]=c.useState(""),[q,h]=c.useState(!1),B=a=>{let l="default",j=null;switch(a){case"en_attente":l="warning";break;case"validé":l="success",j=e.jsx(C,{fontSize:"small"});break;case"rejeté":l="error",j=e.jsx(y,{fontSize:"small"});break;default:l="default"}return e.jsx(P,{label:a.charAt(0).toUpperCase()+a.slice(1).replace("_"," "),color:l,size:"small",icon:j})},M=()=>{if(!u.trim()){g("Le motif de rejet est requis");return}x.post(route("admin.inventaire.ajustement.rejeter",[s.user.id,r.id]),{motif_rejet:u},{onSuccess:()=>{d(!1),v("")}})},I=()=>{x.get(route("admin.inventaire.ajustement.valider",[s.user.id,r.id]))};return e.jsx(L,{auth:s,success:_,error:A,active:"stock",sousActive:"inventaire",breadcrumbs:[{text:"Inventaire",href:route("admin.stock.inventaire.index",[s.user.id]),active:!1},{text:"Ajustements d'inventaire",href:route("admin.inventaire.ajustement.index",[s.user.id]),active:!1},{text:`Ajustement #${r.id}`,href:route("admin.inventaire.ajustement.show",[s.user.id,r.id]),active:!0}],children:e.jsxs(T,{elevation:3,className:"p-6",children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(i,{variant:"h5",component:"h1",children:["Détails de l'ajustement #",r.id]}),e.jsx(n,{variant:"outlined",startIcon:e.jsx(z,{}),onClick:()=>x.get(route("admin.inventaire.ajustement.index",s.user.id)),children:"Retour à la liste"})]}),e.jsxs(t,{container:!0,spacing:4,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(f,{elevation:2,children:e.jsxs(p,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Informations générales"}),e.jsx(m,{sx:{mb:2}}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsxs(t,{item:!0,xs:6,children:[e.jsx(i,{variant:"subtitle2",children:"Status"}),e.jsx(o,{mt:.5,children:B(r.status)})]}),e.jsxs(t,{item:!0,xs:6,children:[e.jsx(i,{variant:"subtitle2",children:"Date d'ajustement"}),e.jsx(i,{variant:"body2",children:F(r.date_ajustement).format("DD/MM/YYYY HH:mm")})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle2",children:"Produit"}),e.jsxs(i,{variant:"body2",children:[e.jsx("strong",{children:r.produit.nom})," (",r.produit.code,")"]})]}),e.jsxs(t,{item:!0,xs:6,children:[e.jsx(i,{variant:"subtitle2",children:"Quantité avant"}),e.jsx(i,{variant:"body2",children:r.quantite_avant.toLocaleString("fr-FR")})]}),e.jsxs(t,{item:!0,xs:6,children:[e.jsx(i,{variant:"subtitle2",children:"Quantité après"}),e.jsx(i,{variant:"body2",children:r.quantite_apres.toLocaleString("fr-FR")})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle2",children:"Différence"}),e.jsxs(i,{variant:"body2",sx:{color:r.difference===0?"success.main":r.difference>0?"info.main":"error.main",fontWeight:"bold"},children:[r.difference>0?"+":"",r.difference.toLocaleString("fr-FR")]})]}),r.departement&&e.jsxs(t,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle2",children:"Département"}),e.jsx(i,{variant:"body2",children:r.departement.nom})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle2",children:"Créé par"}),e.jsxs(i,{variant:"body2",children:[r.user.prenom," ",r.user.nom]})]})]})]})})}),e.jsxs(t,{item:!0,xs:12,md:6,children:[e.jsx(f,{elevation:2,children:e.jsxs(p,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Motif et notes"}),e.jsx(m,{sx:{mb:2}}),e.jsxs(o,{mb:3,children:[e.jsx(i,{variant:"subtitle2",children:"Motif de l'ajustement"}),e.jsx(i,{variant:"body2",sx:{mt:1,p:2,bgcolor:"#f5f5f5",borderRadius:1},children:r.motif})]}),r.notes&&e.jsxs(o,{children:[e.jsx(i,{variant:"subtitle2",children:"Notes additionnelles"}),e.jsx(i,{variant:"body2",sx:{mt:1,p:2,bgcolor:"#f5f5f5",borderRadius:1,whiteSpace:"pre-line"},children:r.notes})]}),r.inventaire_physique_id&&e.jsxs(o,{mt:3,children:[e.jsx(i,{variant:"subtitle2",children:"Origine"}),e.jsxs(i,{variant:"body2",sx:{mt:1},children:["Cet ajustement a été généré à partir de l'inventaire physique #",r.inventaire_physique_id,".",e.jsx(n,{size:"small",sx:{ml:1},onClick:()=>x.get(route("admin.inventaire.physique.show",[s.user.id,r.inventaire_physique_id])),children:"Voir l'inventaire"})]})]})]})}),r.status==="en_attente"&&e.jsx(f,{elevation:2,sx:{mt:2},children:e.jsxs(p,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Actions"}),e.jsx(m,{sx:{mb:2}}),e.jsxs(o,{display:"flex",gap:2,children:[e.jsx(n,{variant:"contained",color:"success",startIcon:e.jsx(C,{}),onClick:()=>h(!0),fullWidth:!0,children:"Valider l'ajustement"}),e.jsx(n,{variant:"contained",color:"error",startIcon:e.jsx(y,{}),onClick:()=>d(!0),fullWidth:!0,children:"Rejeter l'ajustement"})]})]})})]})]}),e.jsxs(D,{open:w,onClose:()=>d(!1),children:[e.jsx(S,{children:"Rejeter l'ajustement"}),e.jsx(R,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"mb-4",children:["Vous êtes sur le point de rejeter l'ajustement pour le produit",e.jsxs("strong",{children:[" ",r.produit.nom]})," avec une différence de",e.jsxs("strong",{children:[" ",r.difference>0?"+":"",r.difference]}),"."]}),e.jsx(E,{autoFocus:!0,margin:"dense",label:"Motif du rejet",fullWidth:!0,multiline:!0,rows:3,value:u,onChange:a=>{v(a.target.value),a.target.value.trim()&&g("")},error:!!b,helperText:b})]})}),e.jsxs(k,{children:[e.jsx(n,{onClick:()=>d(!1),color:"primary",children:"Annuler"}),e.jsx(n,{onClick:M,color:"error",variant:"contained",children:"Rejeter"})]})]}),e.jsxs(D,{open:q,onClose:()=>h(!1),children:[e.jsx(S,{children:"Confirmation"}),e.jsx(R,{children:e.jsxs("p",{children:['Êtes-vous sûr de vouloir valider cet ajustement ? Le stock du produit "',r.produit.nom,'" sera ajusté de ',r.difference>0?"+":"",r.difference,"."]})}),e.jsxs(k,{children:[e.jsx(n,{onClick:()=>h(!1),color:"error",children:"Annuler"}),e.jsx(n,{onClick:I,color:"primary",variant:"contained",children:"Confirmer"})]})]})]})})};export{re as default};
